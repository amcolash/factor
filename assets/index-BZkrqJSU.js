const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-C6wWMAoU.css"])))=>i.map(i=>d[i]);
import{r as d,B as p,u as L,a as ce,d as v,j as t,t as N,b as U,c as le,F as de,P as ue,e as $,J as ge,f as fe,g as me,h as Ae,i as pe,k as he,l as ee,m as we,n as z,p as O,q as xe,s as ye,v as be,T as je,C as Ce,w as ve,x as Ee,y as Be,z as Ie,Q as Me,X as Ne}from"./vendor-57jBAeOT.js";import{i as ke,g as De,a as Qe,p as Se,d as Te,u as B,b as W,t as Fe,c as Ye,e as H,s as ze}from"./firebase-CCkfBKvM.js";import{i as Ge,s as Pe,a as Re}from"./simple-icons-CEts9Dpn.js";import{J as Le}from"./qr-scanner-X-DiGqhs.js";import"./index-BZkrqJSU.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function Ot(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Wt(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var n=function s(){return this instanceof s?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};n.prototype=r.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var o=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:function(){return e[s]}})}),n}const F=d.createContext(void 0);function Ue(){const[e,r]=d.useState(navigator.onLine);return d.useEffect(()=>{function n(){r(navigator.onLine)}return window.addEventListener("online",n),window.addEventListener("offline",n),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",n)}},[]),e}const Oe="modulepreload",We=function(e){return"/factor/"+e},K={},He=function(r,n,s){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(l=>{if(l=We(l),l in K)return;K[l]=!0;const g=l.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const u=document.createElement("link");if(u.rel=g?"stylesheet":Oe,g||(u.as="script"),u.crossOrigin="",u.href=l,c&&u.setAttribute("nonce",c),document.head.appendChild(u),g)return new Promise((f,A)=>{u.addEventListener("load",f),u.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return o.then(i=>{for(const c of i||[])c.status==="rejected"&&a(c.reason);return r().catch(a)})};function Ke(e={}){const{immediate:r=!1,onNeedRefresh:n,onOfflineReady:s,onRegistered:o,onRegisteredSW:a,onRegisterError:i}=e;let c,l,g;const m=async(f=!0)=>{await l,g==null||g()};async function u(){if("serviceWorker"in navigator){if(c=await He(async()=>{const{Workbox:f}=await import("./vendor-57jBAeOT.js").then(A=>A.I);return{Workbox:f}},__vite__mapDeps([0])).then(({Workbox:f})=>new f("/factor/sw.js",{scope:"/factor/",type:"classic"})).catch(f=>{i==null||i(f)}),!c)return;g=()=>{c==null||c.messageSkipWaiting()};{let f=!1;const A=()=>{f=!0,c==null||c.addEventListener("controlling",w=>{w.isUpdate&&window.location.reload()}),n==null||n()};c.addEventListener("installed",w=>{typeof w.isUpdate>"u"?typeof w.isExternal<"u"&&w.isExternal?A():!f&&(s==null||s()):w.isUpdate||s==null||s()}),c.addEventListener("waiting",A)}c.register({immediate:r}).then(f=>{a?a("/factor/sw.js",f):o==null||o(f)}).catch(f=>{i==null||i(f)})}}return l=u(),m}let M;function Ze(){const e=Ke({onNeedRefresh(){const r="New version installed, tap to update.",n={autoClose:!1,closeOnClick:!0,type:"warning",onClick:()=>{const s="Updating...";M?p.update(M,{render:s,onClick:void 0}):p.warn(s,{autoClose:!1}),e()}};M?p.update(M,{render:r,type:"warning",...n}):M=p.warn(r,n)},onRegistered(r){r&&(setInterval(()=>{r.update()},3e5),r.addEventListener("updatefound",()=>{M||(M=p.info("Downloading new version..."))}))}})}const Xe={apiKey:"AIzaSyDMQ4jffBbrLTjdhy_qS4GeZdbYtzEKHp4",authDomain:"factor-97c20.firebaseapp.com",projectId:"factor-97c20",storageBucket:"factor-97c20.appspot.com",messagingSenderId:"524844196447",appId:"1:524844196447:web:9d5f59006ec0b8e68d31ea"},te=ke(Xe),k=De(te),P=Qe(te,{localCache:Se()});function Ve(){const[e]=L(k),r=Te(P,"users",(e==null?void 0:e.uid)||""),[n,s,o]=ce(r);return{value:n,loading:s,error:o,userRef:r}}function re(e){d.useEffect(()=>{const r=()=>e(!document.hidden);return document.addEventListener("visibilitychange",r),()=>document.removeEventListener("visibilitychange",r)},[e])}async function Je(e,r){const n=p(`Exporting keys ⏳️
This might take some time...`,{autoClose:!1,progress:1/r.keys.length,hideProgressBar:!1}),s=[];for(let c=0;c<r.keys.length;c++){const l=r.keys[c],g=await v.decrypt(e,l.secret);s.push({name:l.name,secret:g.secret}),p.update(n,{progress:c/r.keys.length})}p.done(n);const o=new Blob([JSON.stringify(s)],{type:"text/json"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="keys.json",i.click(),URL.revokeObjectURL(a)}async function qe(e,r,n){const s=document.createElement("input");s.type="file",s.addEventListener("change",o=>{if(s.files&&s.files[0]){const a=s.files[0],i=new FileReader;i.onload=async c=>{try{if(c.target){const l=JSON.parse(c.target.result);let g=0,m=0;for(const u of l){if(!u.name||!u.secret)throw"Invalid file format";const f=u.name;if(r.keys.some(A=>A.name.toLowerCase()===f.toLowerCase()))g++;else{const A=await v.encrypt(e,u.secret);await B(n,{keys:W({name:f,secret:A})}),m++}}g>0&&p.warning(`${g} keys were skipped because they already exist`),m>0&&p.success(`Imported ${l.length-g} keys`)}}catch(l){console.error(l),p.error(l||"Error importing keys")}},i.readAsText(a)}}),s.click()}const Z="device-uuid";function ne(){let e=localStorage.getItem(Z);return e||(e=crypto.getRandomValues(new Uint32Array(32)).toString(),localStorage.setItem(Z,e)),e}const se="/factor/assets/logo-lomxQ9_I.png";function _e({className:e}){return t.jsx("img",{src:se,className:U("h-52",e)})}function S({className:e,children:r,...n}){return t.jsxs("div",{className:"w-screen h-[100svh] flex flex-col justify-center items-center gap-5",...n,children:[t.jsx("h1",{className:"text-center m-0 -mb-1",children:"Factor"}),t.jsx(_e,{className:e}),r,t.jsx("span",{className:N("absolute bottom-1.5 right-2 leading-tight whitespace-pre text-right","text-[8px]"),children:new Date("2024-12-03T06:54:41.149Z").toLocaleString().replace(", ",`
`)})]})}function $e(){const[e]=le(k);return t.jsx("button",{className:"icon bg-danger",onClick:async()=>{try{await e(),await Fe(P),await Ye(P),window.location.reload()}catch(r){console.error(r)}},children:t.jsx(de,{})})}function et({pinRef:e,encryptedCode:r,unlock:n,className:s}){d.useEffect(()=>{setTimeout(()=>{var a;return(a=e.current)==null?void 0:a[0].focus()},250)},[]);const o=async a=>{if((a==null?void 0:a.length)===6)try{const i=await v.decrypt(a,r);n(i.token)}catch(i){console.log(i,a),p.error("Invalid code")}e.current&&(e.current.forEach(i=>{i.value=""}),e.current[0].focus())};return t.jsx("div",{className:U("flex",s),children:t.jsx(ue,{length:6,className:"border border-slate-500 w-10 sm:w-12 h-14 m-1.5 rounded-lg text-center text-6xl p-1",type:"password",inputMode:"numeric",ref:e,onComplete:o})})}const oe=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32)));async function tt(){try{const e=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32))),r=k.currentUser,n={challenge:oe,rp:{name:"Factor"},user:{id:e,name:(r==null?void 0:r.email)||"user@email.com",displayName:(r==null?void 0:r.displayName)||"User"},pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{requireResidentKey:!0}},s=await navigator.credentials.create({publicKey:n});return{userHandle:R(e),credentialId:R(s.rawId)}}catch(e){console.error("Error registering credential:",e)}return null}async function rt(e){try{const r=st(e),n={challenge:oe,allowCredentials:[{type:"public-key",id:r}]},s=await navigator.credentials.get({publicKey:n});if(s!=null&&s.response)return R(s.response.userHandle)}catch(r){console.error("Error authenticating:",r)}return null}function nt(e){const r=new Uint8Array(e),n=Array.from(r);return String.fromCharCode.apply(null,n)}function R(e){return btoa(nt(e))}function st(e){const r=atob(e),n=r.length,s=new ArrayBuffer(n),o=new Uint8Array(s);for(let a=0;a<n;a++)o[a]=r.charCodeAt(a);return s}function ot({userRef:e,encryptedCode:r}){const n=ne(),s=async()=>{try{const o=prompt("Enter pin to register biometric login")||"",a=await v.decrypt(o,r),i=await tt(),c=(i==null?void 0:i.userHandle)||"",l=await v.encrypt(c,a);B(e,{webauthn:W({credentialId:i==null?void 0:i.credentialId,uuid:n,secret:l,userAgent:navigator.userAgent})}),p.success("Successfully enrolled biometric login")}catch(o){console.error(o),p.error("Error registering fingerprint")}};return t.jsx("button",{className:"icon bg-primary text-slate-200",onClick:s,children:t.jsx($,{})})}const X=new Set;function at(e,r){d.useEffect(()=>{X.has(e)||(r(),X.add(e))},[])}function T(e,r,n=600){const s=ge(e,{threshold:n,onCancel:(o,{reason:a})=>{a===fe.CancelledByRelease&&r()}});return()=>({onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&e()},...s()})}function it({webauthn:e,userRef:r,unlock:n}){re(a=>{a&&e&&o()}),at("webauthn",()=>{e&&o()});const s=T(()=>{e&&confirm("Reset Biometric Auth?")&&B(r,{webauthn:H({...e})})},()=>o(),3e3),o=async()=>{try{if(!e)throw"webauthn not defined";const a=await rt(e.credentialId).catch(console.error),i=await v.decrypt(a||"",e.secret);n(i.token)}catch(a){console.error(a),p.error("Invalid biometric login")}};return t.jsx("button",{className:"p-3 rounded-full bg-tertiary text-slate-200 border-2 border-slate-600",...s(),children:t.jsx($,{size:30})})}function ct({unlock:e,encryptedCode:r,data:n,userRef:s}){var c;const o=d.useRef(null),a=ne(),i=(c=n==null?void 0:n.webauthn)==null?void 0:c.find(l=>l.uuid===a);return t.jsxs(S,{onClick:l=>{var m;const g=(m=l.target)==null?void 0:m.nodeName;o.current&&(g==="DIV"||g==="IMG"||g==="H1")&&o.current[0].focus()},style:{marginTop:"calc(-1 * env(keyboard-inset-height) / 2)"},children:[t.jsxs("div",{className:"flex fixed top-4 right-4 gap-2",children:[!i&&t.jsx(ot,{encryptedCode:r,userRef:s}),t.jsx($e,{})]}),t.jsx(et,{pinRef:o,encryptedCode:r,unlock:e}),i&&t.jsx(it,{unlock:e,userRef:s,webauthn:i})]})}function lt(){const[e]=L(k),[r,,n,s]=me(k);return t.jsxs("div",{className:"flex justify-center items-center flex-col",children:[!e&&!n&&t.jsx(dt,{signin:()=>r()}),n&&t.jsx("p",{children:"Loading..."}),s&&t.jsxs("p",{children:["Error: ",s.message]})]})}function dt({signin:e}){return t.jsxs("button",{className:"gsi-material-button",onClick:e,children:[t.jsx("div",{className:"gsi-material-button-state"}),t.jsxs("div",{className:"gsi-material-button-content-wrapper",children:[t.jsx("div",{className:"gsi-material-button-icon",children:t.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",style:{display:"block"},children:[t.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),t.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),t.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),t.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),t.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),t.jsx("span",{className:"gsi-material-button-contents",children:"Sign in with Google"}),t.jsx("span",{style:{display:"none"},children:"Sign in with Google"})]})]})}function ut({lock:e,updateCode:r,editMode:n,setEditMode:s,setEditKey:o,exportKeys:a,importKeys:i}){const c="p-4 rounded-full ",l=c+" !bg-slate-800 !text-primary",g=T(r,e),m=T(()=>s(!n),()=>{n?s(!1):o(!0)});return t.jsxs("div",{className:"fixed bottom-8 right-8 flex gap-4 z-20",children:[n&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:l,onClick:()=>i(),children:t.jsx(Ae,{})}),t.jsx("button",{className:l+" mr-4",onClick:()=>a(),children:t.jsx(pe,{})})]}),t.jsx("button",{className:N(l,n&&"rotate-45"),...m(),children:t.jsx(he,{})}),t.jsx("button",{className:N("transition-transform",c),...g(),children:t.jsx(ee,{})})]})}function gt(){const[e,r]=d.useState(new Date),[n,s]=d.useState(new Date);return d.useEffect(()=>{const o=setInterval(()=>s(new Date),1e3);let a;return setTimeout(()=>{r(new Date),a=setInterval(()=>r(new Date),3e4)},3e4-new Date().getTime()%3e4),()=>{a&&clearInterval(a),clearInterval(o)}},[]),{time:n,timestamp:e}}const V={content:["./index.html","./src/**/*.{js,ts,jsx,tsx}"],theme:{extend:{colors:{primary:"#4b888d",secondary:"#051524",tertiary:"#2c2155",danger:"#f07f7b"},keyframes:{wiggle:{"0%, 100%":{transform:"rotate(-0.5deg)"},"50%":{transform:"rotate(0.5deg)"}}},animation:{wiggle:"wiggle 400ms ease-in-out infinite"}}},plugins:[]};function ft(){return d.useMemo(()=>we(V),[V])}const mt="/factor/assets/bastillion-C8U43q6p.png",At="/factor/assets/betterment-qyE9Qf23.png",pt="data:image/png;base64,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",ht="/factor/assets/guideline-BzofyXre.png",wt="/factor/assets/id.me-DfyXe1at.png",xt="/factor/assets/justworks-BJD2k2It.jpg",yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAYAAAA+VemSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAA+BJREFUeJzt2bFtG1kYRtEnPkXqwNEkrsAVWHAdhIpwF9uDAoGFCO7AzneDSXZLUEJwtgOtoQU0usQ58R984OACD+DNtm0DaDrsPQB4OwFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxht3sPGGOM+/v722VZlr131M05Xx4fH/9+7eZ4PH6ac96916Zrta7r+vz8fN57x4cIeFmWZdu2P/feUXc+n3+MMb6+dnM4HE7btn17n0XXa1mWz2OMv/be4QkNYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCbvceMMYYc86X8/n8Y+8dV+Dnb9z8Gh/ku5fNOV/23jDGGDfbtu29AXgjT2gIEzCECRjCBAxhAoYwAUOYgCHsQ/yhfzwePx0Oh9PeO67Ar6enp++vHTw8PPwxxvjyTnuu1uVyOZ5Op3/23vEhAp5z3m3b9m3vHVfgd77nlzGG3/p/mnPe7b1hDE9oSBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQdrv3gDHGWNd1XZbl89476uacL/91c7lcjnPOu/fYc83WdV333jDGGDfbtu29AXgjT2gIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBD2L7MKSZ5etPMSAAAAAElFTkSuQmCC",bt="data:image/png;base64,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",jt="/factor/assets/twitter-CSQ8FmJA.png",Ct="/factor/assets/uwcu-Cguu5ZT9.png";function vt(e){if(!e)return;let r=Object.entries(Ge).filter(n=>e.toLowerCase().includes(n[1].title.toLowerCase())&&z(e.toLowerCase(),n[1].title.toLowerCase())<e.length/2).sort((n,s)=>z(e.toLowerCase(),n[1].title.toLowerCase())-z(e.toLowerCase(),s[1].title.toLowerCase()))[0];switch(e.toLowerCase()){case"bastillion":return{url:mt,padding:!0,type:"Image"};case"betterment":return{url:At,type:"Image"};case"carta":return{url:pt,type:"Image"};case"facebook":return{...Re,padding:!1,type:"Icon"};case"guideline":return{url:ht,type:"Image"};case"id.me":return{url:wt,type:"Image"};case"justworks":return{url:xt,type:"Image"};case"microsoft":return{url:yt,padding:!0,type:"Image"};case"nas":return{...Pe,type:"Icon"};case"uw credit union":case"uwcu":return{url:Ct,padding:!0,type:"Image"};case"sequoia":return{url:bt,padding:!0,type:"Image"};case"twitter":return{url:jt,padding:!0,type:"Image"}}return r?{...r[1],type:"Icon",padding:!0}:void 0}const G="bg-slate-900",Et="bg-slate-800";function Bt(e){if(!e||e.type==="Image")return{background:G,fill:Et};const r=e;let n=G,s="#"+r.hex;switch(r.title.toLowerCase()){case"amazon":n=G;break;case"microsoft":s="#00a2ed";break;case"github":case"patreon":case"ubisoft":n="bg-slate-100";break}return{background:n,fill:s}}function ae({name:e,className:r}){const n=vt(e),s=Bt(n),o="w-12 h-12 rounded-full border border-slate-400 flex justify-center items-center aspect-square "+s.background+" "+r;return n?n.type==="Image"?t.jsx("img",{src:n.url,className:N(o,"object-cover",n.padding&&"p-1")}):t.jsx("div",{dangerouslySetInnerHTML:{__html:n.svg},className:N(o,n.padding?"p-2.5":"p-0.5"),style:{fill:s.fill}}):t.jsx("div",{className:o,children:t.jsx(ee,{})})}function It({close:e,onScan:r}){return t.jsx("div",{className:"absolute inset-0 w-screen h-screen bg-black flex justify-center z-10",children:t.jsxs("div",{className:"relative w-[100vh] p-2",children:[t.jsx("div",{className:"absolute bottom-14 right-0 left-0 z-10 flex justify-center",children:t.jsx("button",{className:"icon",onClick:e,children:t.jsx(O,{})})}),t.jsx(Le,{onResult:async n=>{try{const s=new URL(n),o=decodeURIComponent(s.pathname.replace("//totp/","")).split(":")[0],a=s.searchParams.get("secret");if(s.protocol!=="otpauth:"||!o||!a)throw new Error(`Invalid URL: ${s.toString()}`);r(o,a),e()}catch(s){console.error(s),p.error("Failed to scan qr code")}},onError:n=>console.error(n==null?void 0:n.message),components:{audio:!1}})]})})}function Mt(e){const[r,n]=d.useState(e.name||""),[s,o]=d.useState(e.secret||""),[a,i]=d.useState(!1),[c,l]=d.useState(!0),[g,m]=d.useState(!1),u=d.useContext(F)||"",f=e.name||e.secret,A=async(w,y)=>{if(w===""||y===""){p.error("Name and secret are required");return}try{m(!0),f&&(e.name!==w||e.secret!==y)&&await B(e.userRef,{keys:H({name:e.name,secret:e.secret})});const E=await v.encrypt(u,{secret:y});await B(e.userRef,{keys:W({name:w,secret:E})}),n(""),o(""),l(!0),e.close()}catch(E){console.error(E),p.error("Failed to add key")}finally{m(!1)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col gap-8",onKeyDown:w=>{w.key==="Enter"&&A(r,s)},children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(ae,{name:r,className:"w-14 h-14 sm:w-16 sm:h-16"}),t.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[t.jsx("input",{value:r,onChange:w=>n(w.target.value),placeholder:"Site name",autoFocus:!0,autoComplete:"false",type:"text"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{value:s,onChange:w=>o(w.target.value),placeholder:"Secret",autoComplete:"false",type:c?"password":"text"}),t.jsx("button",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer bg-transparent",onClick:()=>l(!c),children:c?t.jsx(xe,{}):t.jsx(ye,{})})]})]})]}),t.jsxs("div",{className:"flex gap-4",children:[!f&&t.jsx("button",{onClick:()=>i(!0),children:t.jsx(be,{})}),t.jsx("button",{onClick:()=>A(r,s),className:"flex-1",disabled:g,children:g?f?"Saving":"Adding":f?"Save":"Add"})]})]}),a&&t.jsx(It,{close:()=>i(!1),onScan:(w,y)=>{n(w),o(y)}})]})}function Nt({onClose:e,title:r,children:n}){return t.jsx("div",{className:"fixed z-10 inset-0 bg-slate-900 bg-opacity-75 flex justify-center items-center",onClick:e,onKeyDown:s=>{s.key==="Escape"&&e()},children:t.jsxs("div",{className:"bg-slate-700 rounded-lg p-8 w-full",onClick:s=>s.stopPropagation(),style:{marginTop:"calc(-1 * env(keyboard-inset-height))",maxWidth:"min(80vw, 600px)"},children:[t.jsxs("div",{className:"flex items-center mb-8",children:[t.jsx("h2",{className:"flex-1 text-xl font-medium",children:r}),t.jsx("button",{onClick:e,className:"px-2 bg-slate-600 border-2 border-slate-800",children:t.jsx(O,{})})]}),n]})})}function kt(){const[e,r]=d.useState(null);return[d.useCallback(async s=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(s),r(s),!0}catch(o){return console.warn("Copy failed",o),r(null),!1}},[]),e]}function Dt(){const[e,r]=d.useState(!1);return d.useEffect(()=>{const n=()=>{r(window.innerWidth<500)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),e}function Qt({data:e,userRef:r,timestamp:n,onEdit:s,setEditMode:o,editMode:a,addRecentKey:i}){const c=d.useContext(F)||"",[l,g]=d.useState(""),[m,u]=d.useState(0),f=Dt(),[A]=kt(),w=()=>{a?s():m===0?u(1):D()},y=T(()=>o(!a),w);d.useEffect(()=>{m!==0&&v.decrypt(c,e.secret).then(h=>g(h.secret)).catch(h=>{console.error(h),g("Error")})},[e.secret,c,m]),d.useEffect(()=>{let h;return m!==0&&(h=setTimeout(()=>{u(0)},30*1e3)),()=>{h&&clearTimeout(h)}},[m]);const E=Math.floor(n.getTime()/3e4),b=d.useMemo(()=>{if(l.length===0||l==="Error"||m===0)return"Token Error";try{return je.generate(l.replace(/\s+/g,""),{timestamp:E*3e4}).otp}catch(h){return console.error(h),"Token Error"}},[l,E,m]),D=d.useCallback(()=>{A(b).then(h=>{h&&b!=="Token Error"?p.success(e.name+" code copied",{bodyClassName:f?"text-right":"",autoClose:2500}):p.error("Failed to copy code",{autoClose:2500})}),i(e.name)},[b,e,f,A]);return d.useEffect(()=>{m===1&&b!=="Token Error"&&(D(),u(2))},[m,b]),t.jsxs("div",{className:N("p-3 bg-slate-800 border border-slate-700 rounded-md select-none flex gap-6 justify-between items-center hover:brightness-[90%] relative cursor-pointer transition-all rotate-0",a&&"animate-wiggle"),style:{animationDelay:`${Math.random()*250}ms`},tabIndex:0,...y(),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&w()},children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx(ae,{name:e.name}),t.jsxs("div",{className:"flex flex-col items-start justify-center",children:[t.jsx("h2",{className:"font-bold capitalize",children:e.name}),t.jsx("div",{children:m===0?"*** ***":l.length===0?"Decrypting...":b==="Token Error"?"Token Error":t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2",children:b.slice(0,3)}),t.jsx("span",{children:b.slice(3,6)})]})})]})]}),t.jsx("button",{className:"absolute -top-3 -right-3 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full hover:text-white hover:brightness-100 sm:hover:bg-danger transition-all duration-300",style:{pointerEvents:a?"auto":"none",opacity:a?1:0},tabIndex:a?0:-1,onClick:h=>{h.stopPropagation(),window.confirm(`Are you sure you want to remove ${e.name}? This cannot be undone!`)&&window.confirm("Are you really sure?")&&B(r,{keys:H(e)})},onMouseDown:h=>h.stopPropagation(),onTouchStart:h=>h.stopPropagation(),onPointerDown:h=>h.stopPropagation(),children:t.jsx(O,{})})]})}function St({userData:e,userRef:r,editMode:n,setEditMode:s,editKey:o,setEditKey:a}){const{time:i,timestamp:c}=gt(),l=d.useContext(F)||"",[g,m]=d.useState(""),[u,f]=d.useState(),A=ft(),w=3e4-i.getTime()%3e4,y=Math.ceil(w/1e3),E=30-y;d.useEffect(()=>()=>{s(!1),a(!1)},[]),d.useEffect(()=>{n&&navigator.vibrate&&navigator.vibrate(200)},[n]);const b=Q=>{const I=Q.userKey;try{return t.jsx(Qt,{data:I,userRef:r,timestamp:c,onEdit:()=>{const x=p.info("Decrypting token...",{autoClose:1500});v.decrypt(l,I.secret).then(j=>{p.dismiss(x),a(!0),f({name:I.name,secret:j.secret})}).catch(j=>{p.dismiss(x),console.error(j),p.error("Failed to decrypt token",{autoClose:2500})})},setEditMode:s,editMode:n,addRecentKey:async x=>{let C=e.recentKeys||[];C.includes(x)&&(C=C.filter(ie=>ie!==x)),C.unshift(x),C.length>4&&(C=C.slice(0,4)),await B(r,{recentKeys:C})}})}catch(x){return console.error(x),t.jsxs("div",{children:["Error Loading Token (",I.name,")"]})}},D="w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",h=d.useMemo(()=>{var Q,I;return t.jsxs(t.Fragment,{children:[((Q=e.keys)==null?void 0:Q.length)===0&&t.jsx("div",{className:"text-center text-lg bg-slate-800 p-8 w-full rounded-md",children:"No keys added yet"}),e.keys.length>0&&t.jsxs("div",{className:"w-full max-w-screen-lg",children:[t.jsxs("div",{className:"flex gap-4 sm:gap-6 items-center mb-10",children:[t.jsx("img",{src:se,className:"h-10 aspect-square -mb-0.5"}),t.jsxs("div",{className:"relative w-full",children:[t.jsx("input",{className:"pl-10",type:"search",value:g,placeholder:"Search tokens",onChange:x=>m(x.target.value)}),t.jsx("svg",{className:"fill-slate-400 absolute left-3 top-[11px] h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:t.jsx("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})})]})]}),((I=e.recentKeys)==null?void 0:I.length)>0&&t.jsxs("div",{className:"grid gap-4 sm:gap-6 mb-4 sm:mb-6",children:[t.jsx("h2",{className:"m-0 text-xl leading-none",children:"Recently Used"}),t.jsx("div",{className:D,children:e.recentKeys.map(x=>{const j=e.keys.find(C=>C.name===x);if(j)return t.jsx(b,{userKey:j},j.name)})}),t.jsx("hr",{className:"border-slate-700"})]}),t.jsx("div",{className:D,children:e.keys.filter(x=>g.length===0||x.name.toLowerCase().includes(g.toLowerCase())).sort((x,j)=>x.name.localeCompare(j.name)).map(x=>t.jsx(b,{userKey:x},x.name))})]})]})},[e.keys,e.recentKeys,g,c,r,n]),Y=(E+.15)/29.4*50;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex sm:justify-center pl-8 sm:pl-0 fixed bottom-0 left-0 right-0 z-10 backdrop-blur-lg bg-slate-900 bg-opacity-30 pt-4 border-t-2 border-secondary",children:[t.jsx("div",{className:"w-16 h-16 p-1 mb-6",children:t.jsx(Ce,{value:y-1,maxValue:30,text:y.toString(),styles:ve({textSize:"40px",trailColor:A.theme.colors.slate[700],textColor:A.theme.colors.primary,pathColor:A.theme.colors.primary}),strokeWidth:10})}),t.jsx("div",{className:"fixed bottom-1 h-1.5 bg-primary transition-all duration-700 z-20 rounded",style:{left:`${Y}%`,right:`${Y}%`}})]}),t.jsx("div",{className:"flex flex-col gap-4 m-6 sm:m-8 items-center pb-24",children:h}),o&&t.jsx(Nt,{title:u!=null&&u.name||u!=null&&u.secret?"Edit existing key":"Add a new key",onClose:()=>{a(!1),f(void 0)},children:t.jsx(Mt,{name:u==null?void 0:u.name,secret:u==null?void 0:u.secret,userRef:r,close:()=>{a(!1),f(void 0)}})})]})}function Tt(){const[e,r,n]=L(k);return Ze(),r||n?t.jsx(S,{children:n&&t.jsxs("p",{children:["Error: ",n.message]})}):e?t.jsx(Ft,{user:e}):t.jsx(S,{children:t.jsx(lt,{})})}async function J(e){let r="",n=0;for(;r.length!==6&&n<3;)r=prompt("Set a new 6 digit pin")||"",n++;if(r.length===6&&(prompt("Re-enter 6 digit pin")||"")!==r){p.error("Pins do not match");return}if(r.length===6){e||(e=crypto.getRandomValues(new Uint32Array(32)).toString());try{return await v.encrypt(r,{token:e})}catch(s){console.error(s)}}}function q({className:e}){return Ue()?null:t.jsx(Ee,{className:U("text-danger fixed top-2 right-2 text-2xl z-10 "+e),title:"You are currently offline. It is not recommend to add/edit keys offline to avoid conflicts."})}function Ft({user:e}){var f;const{value:r,loading:n,error:s,userRef:o}=Ve(),[a,i]=d.useState(),[c,l]=d.useState(!1),[g,m]=d.useState(!1);re(A=>{A||i(void 0)}),d.useEffect(()=>{!n&&!s&&(r==null?void 0:r.data())===void 0&&J().then(A=>{A?ze(o,{keys:[],recentKeys:[],email:e.email||"",code:A,webauthn:[]}):p.error("Failed to create user")})},[r,n,s]);const u=async()=>{if(!confirm("Would you like to update your pin?"))return;const A=await J(a);A?B(o,{code:A}):p.error("Failed to update pin")};return n||s||!r||r.data()===void 0?t.jsxs(S,{children:[s&&t.jsxs("p",{children:["Error: ",s.message]}),!r||r.data()===void 0&&t.jsx("p",{children:"No data"})]}):a?t.jsxs(F.Provider,{value:a,children:[t.jsx(q,{}),t.jsx(St,{userData:r.data(),userRef:o,editMode:c,setEditMode:l,editKey:g,setEditKey:m}),t.jsx(ut,{lock:()=>i(void 0),updateCode:u,editMode:c,setEditKey:m,setEditMode:l,exportKeys:()=>Je(a,r.data()),importKeys:()=>qe(a,r.data(),o)})]}):t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"!bottom-4 !right-5 top-auto"}),t.jsx(ct,{unlock:A=>i(A),encryptedCode:(f=r.data())==null?void 0:f.code,data:r.data(),userRef:o})]})}window.global||(window.global=window);globalThis.Buffer=Be.Buffer;const Yt=matchMedia("(display-mode: browser)").matches;Yt||window.resizeTo(500,760);const _=navigator;_.virtualKeyboard&&(_.virtualKeyboard.overlaysContent=!0);function zt(){return t.jsxs(d.StrictMode,{children:[t.jsx(Tt,{}),t.jsx(Me,{theme:"dark",position:"bottom-center",transition:Ne,hideProgressBar:!0,closeButton:!1})]})}Ie.createRoot(document.getElementById("root")).render(t.jsx(zt,{}));export{Wt as a,Ot as g};
//# sourceMappingURL=index-BZkrqJSU.js.map
