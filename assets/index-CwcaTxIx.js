const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-C6wWMAoU.css"])))=>i.map(i=>d[i]);
import{r as l,B as w,u as O,a as se,d as v,j as n,t as I,b as R,c as oe,F as ae,P as ie,e as V,J as ce,f as le,g as ue,h as de,i as fe,k as ge,l as q,m as me,C as Ae,n as he,p as F,q as L,T as pe,s as we,v as xe,w as ye,x as be,y as je,z as ve,A as Ce,D as Ee,Q as Be,X as Ie}from"./vendor-Hc01vheh.js";import{u as j,i as Ne,g as Me,a as ke,p as Se,d as De,b as D,t as Te,c as Qe,e as M,s as Fe}from"./firebase-B8ocBskn.js";import{i as ze,s as Ye,a as Pe}from"./simple-icons-CEts9Dpn.js";import{J as Ge}from"./qr-scanner-C4RGPY4I.js";import"./index-CwcaTxIx.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function Kt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Zt(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var a=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,a.get?a:{enumerable:!0,get:function(){return e[s]}})}),r}function _(e){l.useEffect(()=>{const t=()=>e(!document.hidden);return document.addEventListener("visibilitychange",t),()=>document.removeEventListener("visibilitychange",t)},[e])}function Oe(e){const t=l.useRef();_(r=>{r?(t.current&&clearTimeout(t.current),t.current=void 0):(t.current&&clearTimeout(t.current),t.current=setTimeout(()=>e(void 0),15*1e3))})}function Re(e,t){const[r,s]=l.useState(!1),a=async o=>{const i=o.keys.map(c=>({...c,archived:c.archived??!1}));JSON.stringify(i)!==JSON.stringify(o.keys)&&(console.log("Upgrading user data keys to include archived property"),await j(e,{keys:i}))};l.useEffect(()=>{t&&!r&&(s(!0),a(t))},[t,r])}const T=l.createContext(void 0);function Le(){const[e,t]=l.useState(navigator.onLine);return l.useEffect(()=>{function r(){t(navigator.onLine)}return window.addEventListener("online",r),window.addEventListener("offline",r),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",r)}},[]),e}const Ue="modulepreload",We=function(e){return"/factor/"+e},U={},He=function(t,r,s){let a=Promise.resolve();if(r&&r.length>0){let i=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),m=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=i(r.map(f=>{if(f=We(f),f in U)return;U[f]=!0;const h=f.endsWith(".css"),A=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${A}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":Ue,h||(d.as="script"),d.crossOrigin="",d.href=f,m&&d.setAttribute("nonce",m),document.head.appendChild(d),h)return new Promise((y,p)=>{d.addEventListener("load",y),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${f}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return a.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};function Ke(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:s,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=e;let c,m,f;const h=async(d=!0)=>{await m,f==null||f()};async function A(){if("serviceWorker"in navigator){if(c=await He(async()=>{const{Workbox:d}=await import("./vendor-Hc01vheh.js").then(y=>y.L);return{Workbox:d}},__vite__mapDeps([0])).then(({Workbox:d})=>new d("/factor/sw.js",{scope:"/factor/",type:"classic"})).catch(d=>{i==null||i(d)}),!c)return;f=()=>{c==null||c.messageSkipWaiting()};{let d=!1;const y=()=>{d=!0,c==null||c.addEventListener("controlling",p=>{p.isUpdate&&window.location.reload()}),r==null||r()};c.addEventListener("installed",p=>{typeof p.isUpdate>"u"?typeof p.isExternal<"u"&&p.isExternal?y():!d&&(s==null||s()):p.isUpdate||s==null||s()}),c.addEventListener("waiting",y)}c.register({immediate:t}).then(d=>{o?o("/factor/sw.js",d):a==null||a(d)}).catch(d=>{i==null||i(d)})}}return m=A(),h}let B;function Ze(){const e=Ke({onNeedRefresh(){const t="New version installed, tap to update.",r={autoClose:!1,closeOnClick:!0,type:"warning",onClick:()=>{const s="Updating...";B?w.update(B,{render:s,onClick:void 0}):w.warn(s,{autoClose:!1}),e()}};B?w.update(B,{render:t,type:"warning",...r}):B=w.warn(t,r)},onRegistered(t){t&&(setInterval(()=>{t.update()},3e5),t.addEventListener("updatefound",()=>{B||(B=w.info("Downloading new version..."))}))}})}const Xe={apiKey:"AIzaSyDMQ4jffBbrLTjdhy_qS4GeZdbYtzEKHp4",authDomain:"factor-97c20.firebaseapp.com",projectId:"factor-97c20",storageBucket:"factor-97c20.appspot.com",messagingSenderId:"524844196447",appId:"1:524844196447:web:9d5f59006ec0b8e68d31ea"},$=Ne(Xe),N=Me($),P=ke($,{localCache:Se()});function Je(){const[e]=O(N),t=De(P,"users",(e==null?void 0:e.uid)||""),[r,s,a]=se(t);return{data:r,loading:s,error:a,userRef:t}}async function Ve(e,t){const r=w(`Exporting keys ⏳️
This might take some time...`,{autoClose:!1,progress:1/t.keys.length,hideProgressBar:!1}),s=[];for(let c=0;c<t.keys.length;c++){const m=t.keys[c],f=await v.decrypt(e,m.secret);s.push({...m,secret:f.secret}),w.update(r,{progress:c/t.keys.length})}w.done(r);const a=new Blob([JSON.stringify(s,void 0,2)],{type:"text/json"}),o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download="keys.json",i.click(),URL.revokeObjectURL(o)}async function qe(e,t,r){const s=document.createElement("input");s.type="file",s.addEventListener("change",a=>{if(s.files&&s.files[0]){const o=s.files[0],i=new FileReader;i.onload=async c=>{try{if(c.target){const m=JSON.parse(c.target.result);let f=0,h=0;for(const A of m){if(!A.name||!A.secret)throw"Invalid file format";const{archived:d,name:y}=A;if(t.keys.some(p=>p.name.toLowerCase()===y.toLowerCase()))f++;else{const p=await v.encrypt(e,A.secret);await j(r,{keys:D({name:y,secret:p,archived:d})}),h++}}f>0&&w.warning(`${f} keys were skipped because they already exist`),h>0&&w.success(`Imported ${m.length-f} keys`)}}catch(m){console.error(m),w.error(m||"Error importing keys")}},i.readAsText(o)}}),s.click()}const W="device-uuid";function ee(){let e=localStorage.getItem(W);return e||(e=crypto.getRandomValues(new Uint32Array(32)).toString(),localStorage.setItem(W,e)),e}const te="/factor/assets/logo-lomxQ9_I.png";function _e({className:e}){return n.jsx("img",{src:te,className:R("h-52",e)})}function k({className:e,children:t,...r}){return n.jsxs("div",{className:"w-screen h-[100svh] flex flex-col justify-center items-center gap-5",...r,children:[n.jsx("h1",{className:"text-center m-0 -mb-1",children:"Factor"}),n.jsx(_e,{className:e}),t,n.jsx("span",{className:I("absolute bottom-1.5 right-2 leading-tight whitespace-pre text-right","text-[8px]"),children:new Date("2025-06-26T05:08:05.005Z").toLocaleString().replace(", ",`
`)})]})}function $e(){const[e]=oe(N);return n.jsx("button",{className:"icon bg-danger",onClick:async()=>{try{await e(),await Te(P),await Qe(P),window.location.reload()}catch(t){console.error(t)}},children:n.jsx(ae,{})})}function et({pinRef:e,encryptedCode:t,unlock:r,className:s}){l.useEffect(()=>{setTimeout(()=>{var o;return(o=e.current)==null?void 0:o[0].focus()},250)},[]);const a=async o=>{if((o==null?void 0:o.length)===6)try{const i=await v.decrypt(o,t);r(i.token)}catch(i){console.log(i,o),w.error("Invalid code")}e.current&&(e.current.forEach(i=>{i.value=""}),e.current[0].focus())};return n.jsx("div",{className:R("flex",s),children:n.jsx(ie,{length:6,className:"border border-slate-500 w-10 sm:w-12 h-14 m-1.5 rounded-lg text-center text-6xl p-1",type:"password",inputMode:"numeric",ref:e,onComplete:a})})}const ne=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32)));async function tt(){try{const e=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32))),t=N.currentUser,r={challenge:ne,rp:{name:"Factor"},user:{id:e,name:(t==null?void 0:t.email)||"user@email.com",displayName:(t==null?void 0:t.displayName)||"User"},pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{requireResidentKey:!0}},s=await navigator.credentials.create({publicKey:r});return{userHandle:G(e),credentialId:G(s.rawId)}}catch(e){console.error("Error registering credential:",e)}return null}async function nt(e){try{const t=st(e),r={challenge:ne,allowCredentials:[{type:"public-key",id:t}]},s=await navigator.credentials.get({publicKey:r});if(s!=null&&s.response)return G(s.response.userHandle)}catch(t){console.error("Error authenticating:",t)}return null}function rt(e){const t=new Uint8Array(e),r=Array.from(t);return String.fromCharCode.apply(null,r)}function G(e){return btoa(rt(e))}function st(e){const t=atob(e),r=t.length,s=new ArrayBuffer(r),a=new Uint8Array(s);for(let o=0;o<r;o++)a[o]=t.charCodeAt(o);return s}function ot({userRef:e,encryptedCode:t}){const r=ee(),s=async()=>{try{const a=prompt("Enter pin to register biometric login")||"",o=await v.decrypt(a,t),i=await tt(),c=(i==null?void 0:i.userHandle)||"",m=await v.encrypt(c,o);j(e,{webauthn:D({credentialId:i==null?void 0:i.credentialId,uuid:r,secret:m,userAgent:navigator.userAgent})}),w.success("Successfully enrolled biometric login")}catch(a){console.error(a),w.error("Error registering fingerprint")}};return n.jsx("button",{className:"icon bg-primary text-slate-200",onClick:s,children:n.jsx(V,{})})}const H=new Set;function at(e,t){l.useEffect(()=>{H.has(e)||(t(),H.add(e))},[])}function S(e,t,r=600){const s=ce(e,{threshold:r,onCancel:(a,{reason:o})=>{o===le.CancelledByRelease&&t()}});return()=>({onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&e()},...s()})}function it({webauthn:e,userRef:t,unlock:r}){_(o=>{o&&e&&a()}),at("webauthn",()=>{e&&a()});const s=S(()=>{e&&confirm("Reset Biometric Auth?")&&j(t,{webauthn:M({...e})})},()=>a(),3e3),a=async()=>{try{if(!e)throw"webauthn not defined";const o=await nt(e.credentialId).catch(console.error),i=await v.decrypt(o||"",e.secret);r(i.token)}catch(o){console.error(o),w.error("Invalid biometric login")}};return n.jsx("button",{className:"p-3 rounded-full bg-tertiary text-slate-200 border-2 border-slate-600",...s(),children:n.jsx(V,{size:30})})}function ct({unlock:e,encryptedCode:t,data:r,userRef:s}){var c;const a=l.useRef(null),o=ee(),i=(c=r==null?void 0:r.webauthn)==null?void 0:c.find(m=>m.uuid===o);return n.jsxs(k,{onClick:m=>{var h;const f=(h=m.target)==null?void 0:h.nodeName;a.current&&(f==="DIV"||f==="IMG"||f==="H1")&&a.current[0].focus()},style:{marginTop:"calc(-1 * env(keyboard-inset-height) / 2)"},children:[n.jsxs("div",{className:"flex fixed top-4 right-4 gap-2",children:[!i&&n.jsx(ot,{encryptedCode:t,userRef:s}),n.jsx($e,{})]}),n.jsx(et,{pinRef:a,encryptedCode:t,unlock:e}),i&&n.jsx(it,{unlock:e,userRef:s,webauthn:i})]})}function lt(){const[e]=O(N),[t,,r,s]=ue(N);return n.jsxs("div",{className:"flex justify-center items-center flex-col",children:[!e&&!r&&n.jsx(ut,{signin:()=>t()}),r&&n.jsx("p",{children:"Loading..."}),s&&n.jsxs("p",{children:["Error: ",s.message]})]})}function ut({signin:e}){return n.jsxs("button",{className:"gsi-material-button",onClick:e,children:[n.jsx("div",{className:"gsi-material-button-state"}),n.jsxs("div",{className:"gsi-material-button-content-wrapper",children:[n.jsx("div",{className:"gsi-material-button-icon",children:n.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",style:{display:"block"},children:[n.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),n.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),n.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),n.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),n.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),n.jsx("span",{className:"gsi-material-button-contents",children:"Sign in with Google"}),n.jsx("span",{style:{display:"none"},children:"Sign in with Google"})]})]})}function dt({lock:e,updateCode:t,editMode:r,setEditMode:s,setEditKey:a,exportKeys:o,importKeys:i}){const c="p-4 rounded-full ",m=c+" !bg-slate-800 !text-primary",f=S(t,e),h=S(()=>s(!r),()=>{r?s(!1):a(!0)});return n.jsxs("div",{className:"fixed bottom-8 right-8 flex gap-4 z-20",children:[r&&n.jsxs(n.Fragment,{children:[n.jsx("button",{className:m,onClick:()=>i(),children:n.jsx(de,{})}),n.jsx("button",{className:m+" mr-4",onClick:()=>o(),children:n.jsx(fe,{})})]}),n.jsx("button",{className:I(m,r&&"rotate-45"),...h(),children:n.jsx(ge,{})}),n.jsx("button",{className:I("transition-transform",c),...f(),children:n.jsx(q,{})})]})}function ft(){const[e,t]=l.useState(new Date);return l.useEffect(()=>{let r;return setTimeout(()=>{t(new Date),r=setInterval(()=>t(new Date),3e4)},3e4-new Date().getTime()%3e4),()=>{r&&clearInterval(r)}},[]),{timestamp:e}}function gt(){const[e,t]=l.useState(new Date);return l.useEffect(()=>{const r=setInterval(()=>t(new Date),1e3);return()=>{clearInterval(r)}},[]),{time:e}}const K={content:["./index.html","./src/**/*.{js,ts,jsx,tsx}"],theme:{extend:{colors:{primary:"#4b888d",secondary:"#051524",tertiary:"#2c2155",danger:"#f07f7b",warning:"#f0c27b"},keyframes:{wiggle:{"0%, 100%":{transform:"rotate(-0.5deg)"},"50%":{transform:"rotate(0.5deg)"}}},animation:{wiggle:"wiggle 400ms ease-in-out infinite"}}},plugins:[]};function mt(){return l.useMemo(()=>me(K),[K])}function At(){const e=mt(),{time:t}=gt(),r=3e4-t.getTime()%3e4,s=Math.ceil(r/1e3),o=(30-s+.15)/29.4*50;return n.jsxs("div",{className:"flex sm:justify-center pl-8 sm:pl-0 fixed bottom-0 left-0 right-0 z-10 backdrop-blur-lg bg-slate-900 bg-opacity-30 pt-4 border-t-2 border-secondary",children:[n.jsx("div",{className:"w-16 h-16 p-1 mb-6",children:n.jsx(Ae,{value:s-1,maxValue:30,text:s.toString(),styles:he({textSize:"40px",trailColor:e.theme.colors.slate[700],textColor:e.theme.colors.primary,pathColor:e.theme.colors.primary}),strokeWidth:10})}),n.jsx("div",{className:"fixed bottom-1 h-1.5 bg-primary transition-all duration-700 z-20 rounded",style:{left:`${o}%`,right:`${o}%`}})]})}const ht=()=>{const[e,t]=l.useState(r());function r(){const s=window.innerWidth;return s<640?"sm":s<768?"md":s<1024?"lg":s<1280?"xl":"2xl"}return l.useEffect(()=>{const s=()=>{t(r())};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),e},pt="/factor/assets/bastillion-C8U43q6p.png",wt="/factor/assets/betterment-qyE9Qf23.png",xt="data:image/png;base64,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",yt="/factor/assets/guideline-BzofyXre.png",bt="/factor/assets/id.me-DfyXe1at.png",jt="/factor/assets/justworks-BJD2k2It.jpg",vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAYAAAA+VemSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAA+BJREFUeJzt2bFtG1kYRtEnPkXqwNEkrsAVWHAdhIpwF9uDAoGFCO7AzneDSXZLUEJwtgOtoQU0usQ58R984OACD+DNtm0DaDrsPQB4OwFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxht3sPGGOM+/v722VZlr131M05Xx4fH/9+7eZ4PH6ac96916Zrta7r+vz8fN57x4cIeFmWZdu2P/feUXc+n3+MMb6+dnM4HE7btn17n0XXa1mWz2OMv/be4QkNYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCbvceMMYYc86X8/n8Y+8dV+Dnb9z8Gh/ku5fNOV/23jDGGDfbtu29AXgjT2gIEzCECRjCBAxhAoYwAUOYgCHsQ/yhfzwePx0Oh9PeO67Ar6enp++vHTw8PPwxxvjyTnuu1uVyOZ5Op3/23vEhAp5z3m3b9m3vHVfgd77nlzGG3/p/mnPe7b1hDE9oSBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQdrv3gDHGWNd1XZbl89476uacL/91c7lcjnPOu/fYc83WdV333jDGGDfbtu29AXgjT2gIEzCECRjCBAxhAoYwAUOYgCFMwBAmYAgTMIQJGMIEDGEChjABQ5iAIUzAECZgCBMwhAkYwgQMYQKGMAFDmIAhTMAQJmAIEzCECRjCBAxhAoYwAUOYgCFMwBD2L7MKSZ5etPMSAAAAAElFTkSuQmCC",Ct="data:image/png;base64,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",Et="/factor/assets/twitter-CSQ8FmJA.png",Bt="/factor/assets/uwcu-Cguu5ZT9.png";function It(e){if(!e)return;let t=Object.entries(ze).filter(r=>e.toLowerCase().includes(r[1].title.toLowerCase())&&F(e.toLowerCase(),r[1].title.toLowerCase())<e.length/2).sort((r,s)=>F(e.toLowerCase(),r[1].title.toLowerCase())-F(e.toLowerCase(),s[1].title.toLowerCase()))[0];switch(e.toLowerCase()){case"bastillion":return{url:pt,padding:!0,type:"Image"};case"betterment":return{url:wt,type:"Image"};case"carta":return{url:xt,type:"Image"};case"facebook":return{...Pe,padding:!1,type:"Icon"};case"guideline":return{url:yt,type:"Image"};case"id.me":return{url:bt,type:"Image"};case"justworks":return{url:jt,type:"Image"};case"microsoft":return{url:vt,padding:!0,type:"Image"};case"nas":case"synology":return{...Ye,type:"Icon"};case"uw credit union":case"uwcu":return{url:Bt,padding:!0,type:"Image"};case"sequoia":return{url:Ct,padding:!0,type:"Image"};case"twitter":return{url:Et,padding:!0,type:"Image"}}return t?{...t[1],type:"Icon",padding:!0}:void 0}const z="bg-slate-900",Nt="bg-slate-800";function Mt(e){if(!e||e.type==="Image")return{background:z,fill:Nt};const t=e;let r=z,s="#"+t.hex;switch(t.title.toLowerCase()){case"amazon":r=z;break;case"epic games":s="white";break;case"github":case"patreon":case"ubisoft":r="bg-slate-100";break}return{background:r,fill:s}}function re({name:e,className:t}){const r=It(e),s=Mt(r),a="w-12 h-12 rounded-full border border-slate-400 flex justify-center items-center aspect-square "+s.background+" "+t;return r?r.type==="Image"?n.jsx("img",{src:r.url,className:I(a,"object-cover",r.padding&&"p-1")}):n.jsx("div",{dangerouslySetInnerHTML:{__html:r.svg},className:I(a,r.padding?"p-2.5":"p-0.5"),style:{fill:s.fill}}):n.jsx("div",{className:a,children:n.jsx(q,{})})}function kt({close:e,onScan:t}){return n.jsx("div",{className:"absolute inset-0 w-screen h-screen bg-black flex justify-center z-10",children:n.jsxs("div",{className:"relative w-[100vh] p-2",children:[n.jsx("div",{className:"absolute bottom-14 right-0 left-0 z-10 flex justify-center",children:n.jsx("button",{className:"icon",onClick:e,children:n.jsx(L,{})})}),n.jsx(Ge,{onResult:async r=>{try{const s=new URL(r),a=decodeURIComponent(s.pathname.replace("//totp/","")).split(":")[0],o=s.searchParams.get("secret");if(s.protocol!=="otpauth:"||!a||!o)throw new Error(`Invalid URL: ${s.toString()}`);t(a,o),e()}catch(s){console.error(s),w.error("Failed to scan qr code")}},onError:r=>console.error(r==null?void 0:r.message),components:{audio:!1}})]})})}function St(){const[e,t]=l.useState(null);return[l.useCallback(async s=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(s),t(s),!0}catch(a){return console.warn("Copy failed",a),t(null),!1}},[]),e]}function Dt(){const[e,t]=l.useState(!1);return l.useEffect(()=>{const r=()=>{t(window.innerWidth<500)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),e}const E=new Map;function Y({data:e,userRef:t,timestamp:r,onEdit:s,setEditMode:a,editMode:o,addRecentKey:i}){const c=l.useContext(T)||"",[m,f]=l.useState(E.get(e.name)||""),[h,A]=l.useState(0),d=Dt(),[y]=St(),p=l.useCallback(()=>{o?s():h===0?A(1):b()},[o,h]),C=S(()=>a(!o),p);l.useEffect(()=>{m.length>0&&A(2)},[]),l.useEffect(()=>{if(h!==0){if(E.has(e.name)){f(E.get(e.name)||"");return}v.decrypt(c,e.secret).then(g=>{f(g.secret),E.set(e.name,g.secret)}).catch(g=>{console.error(g),f("Error"),E.delete(e.name)})}},[e.secret,c,h]),l.useEffect(()=>{let g;return h!==0&&(g=setTimeout(()=>{A(0)},30*1e3)),()=>{g&&clearTimeout(g)}},[h]);const x=Math.floor(r.getTime()/3e4),u=l.useMemo(()=>{if(m.length===0||m==="Error"||h===0)return"Token Error";try{return pe.generate(m.replace(/\s+/g,""),{timestamp:x*3e4}).otp}catch(g){return console.error(g),"Token Error"}},[m,x,h]),b=l.useCallback(()=>{y(u).then(g=>{g&&u!=="Token Error"?w.success(e.name+" code copied",{bodyClassName:d?"text-right":"",autoClose:2500}):w.error("Failed to copy code",{autoClose:2500})}),i(e.name)},[u,e,d,y]);return l.useEffect(()=>{h===1&&u!=="Token Error"&&(b(),A(2))},[h,u]),e.archived&&!o?null:n.jsxs("div",{className:I("p-3 bg-slate-800 border border-slate-700 rounded-md select-none flex gap-6 justify-between items-center hover:brightness-[90%] relative cursor-pointer transition-all rotate-0",o&&"animate-wiggle",e.archived&&"opacity-50"),style:{animationDelay:`${Math.random()*250}ms`},tabIndex:0,...C(),onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&p()},children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsx(re,{name:e.name}),n.jsxs("div",{className:"flex flex-col items-start justify-center",children:[n.jsx("h2",{className:"font-bold capitalize",children:e.name}),n.jsx("div",{children:h===0?"*** ***":m.length===0?"Decrypting...":u==="Token Error"?"Token Error":n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"mr-2",children:u.slice(0,3)}),n.jsx("span",{children:u.slice(3,6)})]})})]})]}),n.jsx("button",{className:"remove absolute -top-3 right-6 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full sm:hover:bg-warning transition-all duration-300",style:{pointerEvents:o?"auto":"none",opacity:o?1:0},tabIndex:o?0:-1,onClick:async g=>{g.stopPropagation(),window.confirm(`Are you sure you want to ${e.archived?"unarchive":"archive"} ${e.name}?`)&&(await j(t,{keys:M({name:e.name,secret:e.secret,archived:e.archived})}),await j(t,{keys:D({name:e.name,secret:e.secret,archived:!e.archived})}))},onMouseDown:g=>g.stopPropagation(),onTouchStart:g=>g.stopPropagation(),onPointerDown:g=>g.stopPropagation(),children:n.jsx(we,{})}),n.jsx("button",{className:"remove absolute -top-3 -right-3 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full hover:text-white sm:hover:bg-danger transition-all duration-300",style:{pointerEvents:o?"auto":"none",opacity:o?1:0},tabIndex:o?0:-1,onClick:g=>{g.stopPropagation(),window.confirm(`Are you sure you want to remove ${e.name}? This cannot be undone!`)&&window.confirm(`Are you really sure you want to delete ${e.name}?`)&&j(t,{keys:M(e)})},onMouseDown:g=>g.stopPropagation(),onTouchStart:g=>g.stopPropagation(),onPointerDown:g=>g.stopPropagation(),children:n.jsx(L,{})})]})}function Tt(e){const[t,r]=l.useState(e.name||""),[s,a]=l.useState(""),[o,i]=l.useState(!1),[c,m]=l.useState(!0),[f,h]=l.useState(!1),[A,d]=l.useState(!1),y=l.useContext(T)||"",p=e.name||e.secret;l.useEffect(()=>{if(e.name&&e.secret){if(E.has(e.name)){a(E.get(e.name));return}d(!0),v.decrypt(y,e.secret).then(x=>{a(x.secret)}).catch(x=>{console.error(x),w.error("Failed to decrypt token.",{autoClose:2500}),e.close()}).finally(()=>d(!1))}},[]);const C=async(x,u)=>{if(x===""||u===""){w.error("Name and secret are required");return}if(p&&e.name===x&&e.secret===u){e.close();return}try{h(!0),p&&(await j(e.userRef,{keys:M({name:e.name,secret:e.secret,archived:e.archived})}),e.name&&E.delete(e.name));const b=await v.encrypt(y,{secret:u});await j(e.userRef,{keys:D({name:x,secret:b,archived:e.archived})}),r(""),a(""),m(!0),e.close()}catch(b){console.error(b),w.error("Failed to add key")}finally{h(!1)}};return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col gap-8",onKeyDown:x=>{x.key==="Enter"&&C(t,s)},children:[n.jsxs("div",{className:"flex gap-4 items-center",children:[n.jsx(re,{name:t,className:"w-14 h-14 sm:w-16 sm:h-16"}),n.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[n.jsx("input",{value:t,onChange:x=>r(x.target.value),placeholder:"Site name",autoFocus:!0,autoComplete:"false",type:"text"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{value:s,onChange:x=>a(x.target.value),placeholder:A?"Decrypting":"Secret",autoComplete:"false",type:c?"password":"text",disabled:A}),n.jsx("button",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer bg-transparent",onClick:()=>m(!c),children:c?n.jsx(xe,{}):n.jsx(ye,{})})]})]})]}),n.jsxs("div",{className:"flex gap-4",children:[!p&&n.jsx("button",{onClick:()=>i(!0),children:n.jsx(be,{})}),n.jsx("button",{onClick:()=>C(t,s),className:"flex-1",disabled:f,children:f?p?"Saving":"Adding":p?"Save":"Add"})]})]}),o&&n.jsx(kt,{close:()=>i(!1),onScan:(x,u)=>{r(x),a(u)}})]})}function Qt({onClose:e,title:t,children:r}){return n.jsx("div",{className:"fixed z-10 inset-0 bg-slate-900 bg-opacity-75 flex justify-center items-center",onClick:e,onKeyDown:s=>{s.key==="Escape"&&e()},children:n.jsxs("div",{className:"bg-slate-700 rounded-lg p-8 w-full",onClick:s=>s.stopPropagation(),style:{marginTop:"calc(-1 * env(keyboard-inset-height))",maxWidth:"min(80vw, 600px)"},children:[n.jsxs("div",{className:"flex items-center mb-8",children:[n.jsx("h2",{className:"flex-1 text-xl font-medium",children:t}),n.jsx("button",{onClick:e,className:"px-2 bg-slate-600 border-2 border-slate-800",children:n.jsx(L,{})})]}),r]})})}function Ft({userData:e,userRef:t,editMode:r,setEditMode:s,editKey:a,setEditKey:o}){var x;const{timestamp:i}=ft(),c=ht(),m=l.useContext(T)||"",[f,h]=l.useState(""),[A,d]=l.useState();l.useEffect(()=>()=>{s(!1),o(!1)},[]),l.useEffect(()=>{r&&navigator.vibrate&&navigator.vibrate(200)},[r]);const y=l.useCallback(async u=>{let g=[...e.recentKeys||[]];g.includes(u)&&(g=g.filter(Q=>Q!==u)),g.unshift(u),g.length>4&&(g=g.slice(0,4)),JSON.stringify(g)!==JSON.stringify(e.recentKeys)&&await j(t,{recentKeys:g})},[e.recentKeys,t]),p=l.useCallback(u=>{o(!0),d({name:u.name,secret:u.secret,archived:u.archived})},[m,o,d]),C="w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6";return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"flex flex-col gap-4 m-6 sm:m-8 items-center pb-24",children:((x=e.keys)==null?void 0:x.length)===0?n.jsx("div",{className:"text-center text-lg bg-slate-800 p-8 w-full rounded-md",children:"No keys added yet"}):n.jsxs("div",{className:"w-full max-w-screen-lg",children:[n.jsxs("div",{className:"flex gap-4 sm:gap-6 items-center mb-10",children:[n.jsx("img",{src:te,className:"h-10 aspect-square -mb-0.5"}),n.jsxs("div",{className:"relative w-full",children:[n.jsx("input",{className:"pl-10",type:"search",value:f,placeholder:"Search tokens",onChange:u=>h(u.target.value),autoFocus:!0}),n.jsx(je,{className:"fill-slate-400 absolute left-3 top-[11px] h-4"})]})]}),e.recentKeys.length>0&&n.jsxs("div",{className:"grid gap-4 sm:gap-6 mb-4 sm:mb-6",children:[n.jsx("h2",{className:"m-0 text-xl leading-none",children:"Recently Used"}),n.jsx("div",{className:C,children:e.recentKeys.slice(0,c==="sm"||c==="lg"?3:4).map(u=>{const b=e.keys.find(g=>g.name===u);if(b)return n.jsx(Y,{data:b,userRef:t,timestamp:i,onEdit:()=>p(b),setEditMode:s,editMode:r,addRecentKey:y},b.name+b.secret)})}),n.jsx("hr",{className:"border-slate-700"})]}),n.jsx("div",{className:C,children:e.keys.filter(u=>(f.length===0||u.name.toLowerCase().includes(f.toLowerCase()))&&!u.archived).sort((u,b)=>u.name.localeCompare(b.name)).map(u=>n.jsx(Y,{data:u,userRef:t,timestamp:i,onEdit:()=>p(u),setEditMode:s,editMode:r,addRecentKey:y},u.name+u.secret))}),r&&n.jsxs("div",{className:"mt-4 pt-4 sm:mt-6 sm:pt-6 border-t-2 border-slate-700",children:[n.jsx("h2",{className:"mb-4 sm:mb-6 text-xl leading-none",children:"Archived Tokens"}),n.jsx("div",{className:C,children:e.keys.filter(u=>(f.length===0||u.name.toLowerCase().includes(f.toLowerCase()))&&u.archived).sort((u,b)=>u.name.localeCompare(b.name)).map(u=>n.jsx(Y,{data:u,userRef:t,timestamp:i,onEdit:()=>p(u),setEditMode:s,editMode:r,addRecentKey:y},u.name+u.secret))})]})]})}),a&&n.jsx(Qt,{title:A!=null&&A.name||A!=null&&A.secret?"Edit existing key":"Add a new key",onClose:()=>{o(!1),d(void 0)},children:n.jsx(Tt,{name:A==null?void 0:A.name,secret:A==null?void 0:A.secret,archived:(A==null?void 0:A.archived)||!1,userRef:t,close:()=>{o(!1),d(void 0)}})})]})}function zt(){const[e,t,r]=O(N);return Ze(),t||r?n.jsx(k,{children:r&&n.jsxs("p",{children:["Error: ",r.message]})}):e?n.jsx(Yt,{user:e}):n.jsx(k,{children:n.jsx(lt,{})})}async function Z(e){let t="",r=0;for(;t.length!==6&&r<3;)t=prompt("Set a new 6 digit pin")||"",r++;if(t.length===6&&(prompt("Re-enter 6 digit pin")||"")!==t){w.error("Pins do not match");return}if(t.length===6){e||(e=crypto.getRandomValues(new Uint32Array(32)).toString());try{return await v.encrypt(t,{token:e})}catch(s){console.error(s)}}}function X({className:e}){return Le()?null:n.jsx(ve,{className:R("text-danger fixed top-2 right-2 text-2xl z-10 "+e),title:"You are currently offline. It is not recommend to add/edit keys offline to avoid conflicts."})}function Yt({user:e}){const{data:t,loading:r,error:s,userRef:a}=Je(),[o,i]=l.useState(),[c,m]=l.useState(!1),[f,h]=l.useState(!1);Re(a,t),Oe(i),l.useEffect(()=>{!r&&!s&&!t&&Z().then(d=>{d?Fe(a,{keys:[],recentKeys:[],email:e.email||"",code:d,webauthn:[]}):w.error("Failed to create user")})},[t,r,s]);const A=async()=>{if(!confirm("Would you like to update your pin?"))return;const d=await Z(o);d?j(a,{code:d}):w.error("Failed to update pin")};return r||s||!t?n.jsxs(k,{children:[s&&n.jsxs("p",{children:["Error: ",s.message]}),!t&&n.jsx("p",{children:"No data"})]}):o?n.jsxs(T.Provider,{value:o,children:[n.jsx(X,{}),n.jsx(Ft,{userData:t,userRef:a,editMode:c,setEditMode:m,editKey:f,setEditKey:h}),n.jsx(At,{}),n.jsx(dt,{lock:()=>i(void 0),updateCode:A,editMode:c,setEditKey:h,setEditMode:m,exportKeys:()=>Ve(o,t),importKeys:()=>qe(o,t,a)})]}):n.jsxs(n.Fragment,{children:[n.jsx(X,{className:"!bottom-4 !right-5 top-auto"}),n.jsx(ct,{unlock:d=>i(d),encryptedCode:t==null?void 0:t.code,data:t,userRef:a})]})}window.global||(window.global=window);globalThis.Buffer=Ce.Buffer;const Pt=matchMedia("(display-mode: browser)").matches;Pt||window.resizeTo(500,760);const J=navigator;J.virtualKeyboard&&(J.virtualKeyboard.overlaysContent=!0);function Gt(){return n.jsxs(n.Fragment,{children:[n.jsx(zt,{}),n.jsx(Be,{theme:"dark",position:"bottom-center",transition:Ie,hideProgressBar:!0,closeButton:!1,autoClose:5e3})]})}Ee.createRoot(document.getElementById("root")).render(n.jsx(Gt,{}));export{Zt as a,Kt as g};
//# sourceMappingURL=index-CwcaTxIx.js.map
