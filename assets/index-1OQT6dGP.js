function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["/factor/assets/vendor-DiFyTCEx.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as u,u as I,a as Z,B as x,d as S,e as D,j as e,b as q,F as V,P as J,c as Q,J as M,f as _,g as $,h as ee,i as U,k as P,l as te,m as E,n as R,p as se,q as ne,s as re,T as oe,C as ae,t as ie,v as ce,w as le,x as de,Q as ue,X as fe}from"./vendor-DkBzqjRh.js";import{i as me,g as ge,a as pe,p as he,d as xe,u as v,b as K,t as we,c as ye,e as X,s as je}from"./firebase-sYCQt8ZG.js";import{i as be,s as ve,a as Ce}from"./simple-icons-5YJPn3BQ.js";import{z as Ae}from"./qr-scanner-BJt17_9o.js";import"./index-1OQT6dGP.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ht(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function xt(t){if(t.__esModule)return t;var n=t.default;if(typeof n=="function"){var s=function r(){return this instanceof r?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};s.prototype=n.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(s,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),s}const ke="modulepreload",Ne=function(t,n){return t[0]==="."?new URL(t,n).href:t},z={},Se=function(n,s,r){let a=Promise.resolve();if(s&&s.length>0){const o=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.all(s.map(f=>{if(f=Ne(f,r),f in z)return;z[f]=!0;const d=f.endsWith(".css"),w=d?'[rel="stylesheet"]':"";if(!!r)for(let m=o.length-1;m>=0;m--){const h=o[m];if(h.href===f&&(!d||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${w}`))return;const c=document.createElement("link");if(c.rel=d?"stylesheet":ke,d||(c.as="script",c.crossOrigin=""),c.href=f,l&&c.setAttribute("nonce",l),document.head.appendChild(c),d)return new Promise((m,h)=>{c.addEventListener("load",m),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${f}`)))})}))}return a.then(()=>n()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function Le(t={}){const{immediate:n=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:a,onRegisteredSW:o,onRegisterError:i}=t;let l,f,d;const w=async(c=!0)=>{await f,await(d==null?void 0:d())};async function p(){if("serviceWorker"in navigator){if(l=await Se(()=>import("./vendor-DkBzqjRh.js").then(c=>c.z),__vite__mapDeps([0]),import.meta.url).then(({Workbox:c})=>new c("/factor/sw.js",{scope:"/factor/",type:"classic"})).catch(c=>{i==null||i(c)}),!l)return;d=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let c=!1;const m=()=>{c=!0,l==null||l.addEventListener("controlling",h=>{h.isUpdate&&window.location.reload()}),s==null||s()};l.addEventListener("installed",h=>{typeof h.isUpdate>"u"?typeof h.isExternal<"u"?h.isExternal?m():!c&&(r==null||r()):h.isExternal?window.location.reload():!c&&(r==null||r()):h.isUpdate||r==null||r()}),l.addEventListener("waiting",m),l.addEventListener("externalwaiting",m)}l.register({immediate:n}).then(c=>{o?o("/factor/sw.js",c):a==null||a(c)}).catch(c=>{i==null||i(c)})}}return f=p(),w}const L=u.createContext(void 0);function Ee(){const[t,n]=u.useState(navigator.onLine);return u.useEffect(()=>{function s(){n(navigator.onLine)}return window.addEventListener("online",s),window.addEventListener("offline",s),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",s)}},[]),t}const Fe={apiKey:"AIzaSyDMQ4jffBbrLTjdhy_qS4GeZdbYtzEKHp4",authDomain:"factor-97c20.firebaseapp.com",projectId:"factor-97c20",storageBucket:"factor-97c20.appspot.com",messagingSenderId:"524844196447",appId:"1:524844196447:web:9d5f59006ec0b8e68d31ea"},G=me(Fe),C=ge(G),T=pe(G,{localCache:he()});function Me(){const[t]=I(C),n=xe(T,"users",(t==null?void 0:t.uid)||""),[s,r,a]=Z(n);return{value:s,loading:r,error:a,userRef:n}}async function Pe(t,n){const s=x(`Exporting keys ⏳️
This might take some time...`,{autoClose:!1,progress:1/n.keys.length,hideProgressBar:!1}),r=[];for(let l=0;l<n.keys.length;l++){const f=n.keys[l],d=await S(t,f.secret);r.push({name:f.name,secret:d.secret}),x.update(s,{progress:l/n.keys.length})}x.done(s);const a=new Blob([JSON.stringify(r)],{type:"text/json"}),o=URL.createObjectURL(a),i=document.createElement("a");i.href=o,i.download="keys.json",i.click(),URL.revokeObjectURL(o)}async function Te(t,n,s){const r=document.createElement("input");r.type="file",r.addEventListener("change",a=>{if(r.files&&r.files[0]){const o=r.files[0],i=new FileReader;i.onload=async l=>{try{if(l.target){const f=JSON.parse(l.target.result);let d=0,w=0;for(const p of f){if(!p.name||!p.secret)throw"Invalid file format";const c=p.name;if(n.keys.some(m=>m.name.toLowerCase()===c.toLowerCase()))d++;else{const m=await D(t,p.secret);await v(s,{keys:K({name:c,secret:m})}),w++}}d>0&&x.warning(`${d} keys were skipped because they already exist`),w>0&&x.success(`Imported ${f.length-d} keys`)}}catch(f){console.error(f),x.error(f||"Error importing keys")}},i.readAsText(o)}}),r.click()}const Ie="/factor/assets/logo-lomxQ9_I.png";function De({className:t}){return e.jsx("img",{src:Ie,className:"h-52 "+t})}function N({className:t,children:n,...s}){return e.jsxs("div",{className:"w-screen h-[100svh] flex flex-col justify-center items-center gap-5",...s,children:[e.jsx("h1",{className:"text-center m-0 -mb-1",children:"Factor"}),e.jsx(De,{className:t}),n]})}function Re({unlock:t,encryptedCode:n}){const s=u.useRef(null),[r]=q(C);u.useEffect(()=>{setTimeout(()=>{var o;return(o=s.current)==null?void 0:o[0].focus()},250)},[]);const a=async o=>{if((o==null?void 0:o.length)===6)try{const i=await S(o,n);t(i.token)}catch(i){console.log(i,o),x.error("Invalid code")}s.current&&(s.current.forEach(i=>{i.value=""}),s.current[0].focus())};return e.jsxs(N,{onClick:()=>{s.current&&s.current[0].focus()},style:{marginTop:"calc(-1 * env(keyboard-inset-height) / 2)"},children:[e.jsx("button",{className:"icon fixed top-4 right-4 bg-danger",onClick:async()=>{try{await r(),await we(T),await ye(T)}catch(o){console.error(o)}},children:e.jsx(V,{})}),e.jsx("div",{className:"flex",children:e.jsx(J,{length:6,className:"border border-slate-500 w-10 sm:w-12 h-14 m-1.5 rounded-lg text-center text-6xl p-1",type:"password",inputMode:"numeric",ref:s,onComplete:a,onClick:o=>o.stopPropagation()})})]})}function ze(){const[t]=I(C),[n,,s,r]=Q(C);return e.jsxs("div",{className:"flex justify-center items-center flex-col",children:[!t&&!s&&e.jsx(Oe,{signin:()=>n()}),s&&e.jsx("p",{children:"Loading..."}),r&&e.jsxs("p",{children:["Error: ",r.message]})]})}function Oe({signin:t}){return e.jsxs("button",{className:"gsi-material-button",onClick:t,children:[e.jsx("div",{className:"gsi-material-button-state"}),e.jsxs("div",{className:"gsi-material-button-content-wrapper",children:[e.jsx("div",{className:"gsi-material-button-icon",children:e.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",style:{display:"block"},children:[e.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),e.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),e.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),e.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),e.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),e.jsx("span",{className:"gsi-material-button-contents",children:"Sign in with Google"}),e.jsx("span",{style:{display:"none"},children:"Sign in with Google"})]})]})}function We({lock:t,updateCode:n,editMode:s,setEditMode:r,setEditKey:a,exportKeys:o,importKeys:i}){const l="p-4 rounded-full",f=l+" !bg-slate-800 !text-primary",d=M(n,{threshold:600,onCancel:(p,{reason:c})=>{c===P.CancelledByRelease&&t()}}),w=M(()=>{r(!0)},{threshold:600,onCancel:(p,{reason:c})=>{c===P.CancelledByRelease&&(s?r(!1):setTimeout(()=>a(!0),10))}});return e.jsxs("div",{className:"fixed bottom-8 right-8 flex gap-4 z-20",children:[s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:f,onClick:()=>i(),children:e.jsx(_,{})}),e.jsx("button",{className:f+" mr-4",onClick:()=>o(),children:e.jsx($,{})})]}),e.jsx("button",{className:f+(s?" rotate-45":""),...w(),children:e.jsx(ee,{})}),e.jsx("button",{className:"transition-transform "+l,...d(),children:e.jsx(U,{})})]})}function Be(){const[t,n]=u.useState(new Date),[s,r]=u.useState(new Date);return u.useEffect(()=>{const a=setInterval(()=>r(new Date),1e3);let o;return setTimeout(()=>{n(new Date),o=setInterval(()=>n(new Date),3e4)},3e4-new Date().getTime()%3e4),()=>{o&&clearInterval(o),clearInterval(a)}},[]),{time:s,timestamp:t}}const O={content:["./index.html","./src/**/*.{js,ts,jsx,tsx}"],theme:{extend:{colors:{primary:"#4b888d",secondary:"#051524",tertiary:"#2c2155",danger:"#f07f7b"},keyframes:{wiggle:{"0%, 100%":{transform:"rotate(-0.5deg)"},"50%":{transform:"rotate(0.5deg)"}}},animation:{wiggle:"wiggle 400ms ease-in-out infinite"}}},plugins:[]};function He(){return u.useMemo(()=>te(O),[O])}const Ue="/factor/assets/bastillion-C8U43q6p.png",Ke="/factor/assets/betterment-qyE9Qf23.png",Xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAAAAAAbPrZOAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAACYktHRAD/h4/MvwAAAAd0SU1FB+gDHgYUFh9Sd4UAAAdJSURBVHja7ZxpbBRlGICfHhQspVSLB4IGEVBRMUjxDIoS8IjxxvvCBDSgBu+EH94ooRqPgBJEDMZ4oDE2igikkmi0CFRQiloNUJGrIi29aKl1P3/M7HZmdpntzli2fXmfP51532/e73t2Zuf4ZtMMw6FFZroHoMIqrMIqrMIqrMKHDiosHRWWjgpLR4Wlo8LSUWHpqLB0VFg6KiwdFZaOCktHhaWjwtJRYemosHRUWDoqLB0Vlo4KS0eFpaPC0lFh6aiwdFRYOiosHRWWjgpLR4Wlo8LSUWHpqLB0VFg6KiwdFZaOCksn2y9Z8dgR6R5fAGpmn+aXNj6sTffYg7HWz8n3kM5I99CD4Tts/Q7H0f/Yf9M9yA6TtacqvPCsG9rS7dFhsj++Pbxwbq90a6RAz6Qtkn+Hu9X/gUw+2EPupKXC0lFh6aiwdFRYOiosneQPDweT1ghgenXmxEPX2sNPHjZ06JDcus7somvt4Xq2dXYXXWsPH4TRdC3hg4AKS6crCnfqdHj4s3Rzw4aatuzCk/v0SZBs2F5VF+k76DhvzrRlYOgBtOyryS3IBRozyLHmRxt7GDC9270jDdWVTeSdOCA//cJbP19Ybi8+fG1RjvujWLnsNXtx+sRzMilZ0ROzfy5A5YOHY/YvLGDJM6th7lRo6VOQ2XMnACMjhtbGncfY2zatLFlgLz5+xTnZzP0tm0jejMMCjtjvPUw5wGKfBrsedtUa+5UzWXKmM3d5hXmjvcN1ANRE7gfgTWNMs3dg2+0ynx/pjF7zm5kEcEpjwgF9CFDu5xRKuCTu4yuO5fZP9eZWvtcuvB6Ahmc4sPAOY4wxtdO88TUPAJwVVDjMIT3n/rjQo3XPWgvNY1d7cxdd4AkcXvpEsi72XrDBGxo9NMSQQ32H50V9Z56XwUZ7Tzw38B6Af26L+U4eWv9uFQBfewoUXm0vtCYqHwHMLTHfKSfsWboRgN9DCQc/pJfbBUrt9TUDrfV6Y4x5x04u+NMYY0zzslx3h+tjq6OW/FK1xxjT9k1ZWfk4AJavKisr+7bJGFNsN1q40xhjTP3S2GaBD+nAwjVWx3fWtX9r7wXebDbGmE1WcsLvsWTz5MTCr0WcRW9u/8iMMWaz1WbEjliDugfCCgc+pD8F4KbX23ddzpzqE6cPcCQHf1gQS/aaH3krQZVi92kgAkDs9ewcy21531iD/OLInKAjdn7gqe/hBmvrza5gs/233kr+lGgL1x4e0equeiMAtfbabqtRpavJ7pB7OOitpXUhnXWCKxh9sWrdikw73ZXMWxJf5YUefn1YZ6dnh7mC/d4Pt4ODClcAcGXi5BYA7vZEx8Q3HIMfywCY6IlemBbhyA8AnJQ4uwaAMzzRvDu87S7xf9e+GaDfMZ5o/8vSIdz6FcCIxFtHvgQgyxPOONfb8FLfI9q6EIzr7Y2fRBiC7uHNAP0PMNItieNxVwT/HbyvGmBQ3FbhfiwXUNh6dGv0S3Yg7v/gm9MXYG9cvIEwBBTOmgDw3QFqXpc4XpVaHz0KAVbH+W1Ph3DOWABzgEnViwGo9ETbnkuxk2MB1tV7ok3fp0OY44Ho6TjxSCnzRH9JtY+xAKzwRH/elBZh62p4X4s7utb62ZB1eZ3U5E6+nmofp1plPGeK4lTL/D/CA6cA7HjVFfx6dOaiZuAI657jaVdy6bxU+xgyLkGZTz4KJxz4ack+mhc5Qtbj6tvGGOu2hNmOZJmrw/UAzPMWdd9Lm1XWFs87WpTaVQ76vTRF1nTWnTOjJ5XIMusQHACMfAiAx27ZaicbXj03tfIAnG2d7mdM+tMO1L48LuT+DTEBUBedannpxz17a3Z/Nt5ae8oYY0x1tPz099btrCx50dthx/aw+Tu60SMflFf/WvJKe5U0zGnlf2Ebu2Yub34cgKN+Hm6tv5JKyTgK1xZZCy+GKuMkxJuHIZvOj4s9NN++XTxlY1xu5tzU+xgVNxXIW5NTL/P/CDO49ElPpOSlvOji8F3Xu3Nvz0j+2954Ru/yPGO9e3e4dweh3i31fOoP5xTN/Frn8/HRH21wPMhNq7oLx3XZeqeyz1vQumuMOENHL/rGcSBN2XIr1QCrg/6qOcNvwx9GAYsn+hZoqigt3bJ70PCrhhXFJ/+qWFm6rWXYmEtH5gN1+4GsQgBaADJzPO1r2oCMft6Him2/rviuqvXk88YX5QO1/wDZiZ+ZFt8IlJ+JD4HP0l2STrwOd1dUWDoqLB0Vlo4KS0eFpaPC0lFh6ahwHFkdqNJlSD7flbxFee9u9E8PViVvk3SKp/uhUzxOVNhJ9/kXLR0ftu+89N6qbnWKjvoOKggqLBH9DktHhaWjwtJRYemosHRUWDoqLB0Vlo4KS0eFpaPC0lFh6aiwdFRYOiosHRWWjgpLR4Wlo8LSUWHpqLB0VFg6KiwdFZaOCktHhaWjwtJRYemosHRUWDoqLB0Vlo4KS0eFpaPC0lFh6aiwdFRYOiosnUNO+D9IFel9YsIbrgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0wMy0zMFQwNjoyMDoyMiswMDowMI3CWJcAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMDMtMzBUMDY6MjA6MjIrMDA6MDD8n+ArAAAAKHRFWHRkYXRlOnRpbWVzdGFtcAAyMDI0LTAzLTMwVDA2OjIwOjIyKzAwOjAwq4rB9AAAAABJRU5ErkJggg==",Ge="/factor/assets/guideline-BzofyXre.png",Ye="/factor/assets/id.me-DKMQt8CE.png",Ze="/factor/assets/justworks-GR0TnuZp.jpg",qe="/factor/assets/uwcu-Cguu5ZT9.png";function Ve(t){if(!t)return;let n=Object.entries(be).filter(s=>t.toLowerCase().includes(s[1].title.toLowerCase())&&E(t.toLowerCase(),s[1].title.toLowerCase())<t.length/2).sort((s,r)=>E(t.toLowerCase(),s[1].title.toLowerCase())-E(t.toLowerCase(),r[1].title.toLowerCase()))[0];switch(t.toLowerCase()){case"bastillion":return{url:Ue,padding:!0,type:"Image"};case"betterment":return{url:Ke,type:"Image"};case"carta":return{url:Xe,type:"Image"};case"facebook":return{...Ce,padding:!1,type:"Icon"};case"guideline":return{url:Ge,type:"Image"};case"id.me":return{url:Ye,type:"Image"};case"justworks":return{url:Ze,type:"Image"};case"nas":return{...ve,type:"Icon"};case"uw credit union":case"uwcu":return{url:qe,padding:!0,type:"Image"}}return n?{...n[1],type:"Icon",padding:!0}:void 0}const F="bg-slate-900",Je="bg-slate-800";function Qe(t){if(!t||t.type==="Image")return{background:F,fill:Je};const n=t;let s=F,r="#"+n.hex;switch(n.title.toLowerCase()){case"amazon":s=F;break;case"microsoft":r="#00a2ed";break;case"github":case"patreon":case"ubisoft":s="bg-slate-100";break}return{background:s,fill:r}}function Y({name:t,className:n}){const s=Ve(t),r=Qe(s),a="w-12 h-12 rounded-full border border-slate-400 flex justify-center items-center aspect-square "+r.background+" "+n;return s?s.type==="Image"?e.jsx("img",{src:s.url,className:a+` object-cover ${s.padding?"p-1":""}`}):e.jsx("div",{dangerouslySetInnerHTML:{__html:s.svg},className:`${a} ${s.padding?"p-2.5":"p-0.5"}`,style:{fill:r.fill}}):e.jsx("div",{className:a,children:e.jsx(U,{})})}function _e({close:t,onScan:n}){return e.jsx("div",{className:"absolute inset-0 w-screen h-screen bg-black flex justify-center z-10",children:e.jsxs("div",{className:"relative w-[100vh] p-2",children:[e.jsx("div",{className:"absolute bottom-14 right-0 left-0 z-10 flex justify-center",children:e.jsx("button",{className:"icon",onClick:t,children:e.jsx(R,{})})}),e.jsx(Ae,{onResult:async s=>{try{const r=new URL(s),a=decodeURIComponent(r.pathname.replace("//totp/","")).split(":")[0],o=r.searchParams.get("secret");if(r.protocol!=="otpauth:"||!a||!o)throw new Error(`Invalid URL: ${r.toString()}`);n(a,o),t()}catch(r){console.error(r),x.error("Failed to scan qr code")}},onError:s=>console.error(s==null?void 0:s.message),components:{audio:!1}})]})})}function $e(t){const[n,s]=u.useState(t.name||""),[r,a]=u.useState(t.secret||""),[o,i]=u.useState(!1),[l,f]=u.useState(!0),[d,w]=u.useState(!1),p=u.useContext(L)||"",c=t.name||t.secret,m=async(h,j)=>{if(h===""||j===""){x.error("Name and secret are required");return}try{w(!0),c&&(t.name!==h||t.secret!==j)&&await v(t.userRef,{keys:X({name:t.name,secret:t.secret})});const y=await D(p,{secret:j});await v(t.userRef,{keys:K({name:h,secret:y})}),s(""),a(""),f(!0),t.close()}catch(y){console.error(y),x.error("Failed to add key")}finally{w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-8",onKeyDown:h=>{h.key==="Enter"&&m(n,r)},children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx(Y,{name:n,className:"w-14 h-14 sm:w-16 sm:h-16"}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsx("input",{value:n,onChange:h=>s(h.target.value),placeholder:"Site name",autoFocus:!0,autoComplete:"false",type:"text"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{value:r,onChange:h=>a(h.target.value),placeholder:"Secret",autoComplete:"false",type:l?"password":"text"}),e.jsx("button",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer bg-transparent",onClick:()=>f(!l),children:l?e.jsx(se,{}):e.jsx(ne,{})})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[!c&&e.jsx("button",{onClick:()=>i(!0),children:e.jsx(re,{})}),e.jsx("button",{onClick:()=>m(n,r),className:"flex-1",disabled:d,children:d?c?"Saving":"Adding":c?"Save":"Add"})]})]}),o&&e.jsx(_e,{close:()=>i(!1),onScan:(h,j)=>{s(h),a(j)}})]})}function et({onClose:t,title:n,children:s}){return e.jsx("div",{className:"fixed z-10 inset-0 bg-slate-900 bg-opacity-75 flex justify-center items-center",onClick:t,onKeyDown:r=>{r.key==="Escape"&&t()},children:e.jsxs("div",{className:"bg-slate-700 rounded-lg p-8 w-full",onClick:r=>r.stopPropagation(),style:{marginTop:"calc(-1 * env(keyboard-inset-height))",maxWidth:"min(80vw, 600px)"},children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx("h2",{className:"flex-1 text-xl font-medium",children:n}),e.jsx("button",{onClick:t,className:"px-2 bg-slate-600 border-2 border-slate-800",children:e.jsx(R,{})})]}),s]})})}function tt(){const[t,n]=u.useState(null);return[u.useCallback(async r=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(r),n(r),!0}catch(a){return console.warn("Copy failed",a),n(null),!1}},[]),t]}function st(){const[t,n]=u.useState(!1);return u.useEffect(()=>{const s=()=>{n(window.innerWidth<500)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t}function nt({data:t,userRef:n,timestamp:s,onEdit:r,setEditMode:a,editMode:o}){const i=u.useContext(L)||"",[l,f]=u.useState(""),[d,w]=u.useState(0),p=st(),[c]=tt(),m=()=>{o?r():d===0?w(1):A()},h=M(()=>a(!0),{threshold:600,onCancel:(g,{reason:b})=>{b===P.CancelledByRelease&&m()}});u.useEffect(()=>{d!==0&&S(i,t.secret).then(g=>f(g.secret)).catch(g=>{console.error(g),f("Error")})},[t.secret,i,d]);const j=Math.floor(s.getTime()/3e4),y=u.useMemo(()=>{if(l.length===0||l==="Error"||d===0)return"Token Error";try{return oe.generate(l.replace(/\s+/g,""),{timestamp:j*3e4}).otp}catch(g){return console.error(g),"Token Error"}},[l,j,d]),A=u.useCallback(()=>c(y).then(g=>{g&&y!=="Token Error"?x.success(t.name+" code copied",{bodyClassName:p?"text-right":"",autoClose:2500}):x.error("Failed to copy code",{autoClose:2500})}),[y,t,p,c]);return u.useEffect(()=>{d===1&&y!=="Token Error"&&(A(),w(2))},[d,y]),e.jsxs("div",{className:"p-3 bg-slate-800 border border-slate-700 rounded-md select-none flex gap-6 justify-between items-center hover:brightness-[90%] relative cursor-pointer transition-all rotate-0"+(o?" animate-wiggle":""),style:{animationDelay:`${Math.random()*250}ms`},tabIndex:0,...h(),onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&m()},children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Y,{name:t.name}),e.jsxs("div",{className:"flex flex-col items-start justify-center",children:[e.jsx("h2",{className:"font-bold capitalize",children:t.name}),e.jsx("div",{children:d===0?"*** ***":l.length===0?"Decrypting...":y==="Token Error"?"Token Error":e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-2",children:y.slice(0,3)}),e.jsx("span",{children:y.slice(3,6)})]})})]})]}),e.jsx("button",{className:"absolute -top-3 -right-3 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full hover:text-white hover:brightness-100 sm:hover:bg-danger transition-all duration-300",style:{pointerEvents:o?"auto":"none",opacity:o?1:0},tabIndex:o?0:-1,onClick:g=>{g.stopPropagation(),window.confirm(`Are you sure you want to remove ${t.name}? This cannot be undone!`)&&window.confirm("Are you really sure?")&&v(n,{keys:X(t)})},onMouseDown:g=>g.stopPropagation(),onTouchStart:g=>g.stopPropagation(),onPointerDown:g=>g.stopPropagation(),children:e.jsx(R,{})})]})}function rt({userData:t,userRef:n,editMode:s,setEditMode:r,editKey:a,setEditKey:o}){const{time:i,timestamp:l}=Be(),f=u.useContext(L)||"",[d,w]=u.useState(""),[p,c]=u.useState(),m=He(),h=3e4-i.getTime()%3e4,j=Math.ceil(h/1e3),y=30-j;u.useEffect(()=>{s&&navigator.vibrate&&navigator.vibrate(200)},[s]);const A=u.useMemo(()=>e.jsxs(e.Fragment,{children:[t.keys.length===0&&e.jsx("div",{className:"text-center text-lg bg-slate-800 p-8 w-full rounded-md",children:"No keys added yet"}),t.keys.length>0&&e.jsxs("div",{className:"w-full max-w-screen-lg",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"mb-6 pl-10",type:"search",value:d,placeholder:"Search tokens",onChange:g=>w(g.target.value)}),e.jsx("svg",{className:"fill-slate-400 absolute left-3 top-[11px] h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:e.jsx("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})})]}),e.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",children:t.keys.filter(g=>d.length===0||g.name.toLowerCase().includes(d.toLowerCase())).sort((g,b)=>g.name.localeCompare(b.name)).map(g=>{try{return e.jsx(nt,{data:g,userRef:n,timestamp:l,onEdit:()=>{const b=x.info("Decrypting token...",{autoClose:1500});S(f,g.secret).then(k=>{x.dismiss(b),o(!0),c({name:g.name,secret:k.secret})}).catch(k=>{x.dismiss(b),console.error(k),x.error("Failed to decrypt token",{autoClose:2500})})},setEditMode:r,editMode:s},g.name)}catch(b){return console.error(b),e.jsxs("div",{children:["Error Loading Token (",g.name,")"]})}})})]})]}),[t.keys,d,l,n,s]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex sm:justify-center pl-8 sm:pl-0 fixed bottom-0 left-0 right-0 z-10 backdrop-blur-lg bg-slate-900 bg-opacity-30 pt-4 border-t-2 border-secondary",children:[e.jsx("div",{className:"w-16 h-16 p-1 mb-6",children:e.jsx(ae,{value:j-1,maxValue:30,text:j.toString(),styles:ie({textSize:"40px",trailColor:m.theme.colors.slate[700],textColor:m.theme.colors.primary,pathColor:m.theme.colors.primary}),strokeWidth:10})}),e.jsx("div",{className:"fixed bottom-1 h-1.5 bg-primary transition-all duration-700 z-20 rounded",style:{left:`${y/30*50}%`,right:`${y/30*50}%`}})]}),e.jsx("div",{className:"flex flex-col gap-4 m-6 sm:m-8 items-center pb-24",children:A}),a&&e.jsx(et,{title:p!=null&&p.name||p!=null&&p.secret?"Edit existing key":"Add a new key",onClose:()=>{o(!1),c(void 0)},children:e.jsx($e,{name:p==null?void 0:p.name,secret:p==null?void 0:p.secret,userRef:n,close:()=>{o(!1),c(void 0)}})})]})}function ot(){const[t,n,s]=I(C);return n||s?e.jsx(N,{children:s&&e.jsxs("p",{children:["Error: ",s.message]})}):t?e.jsx(at,{user:t}):e.jsx(N,{children:e.jsx(ze,{})})}async function W(t){let n="",s=0;for(;n.length!==6&&s<3;)n=prompt("Set a new 6 digit pin")||"",s++;if(n.length===6&&(prompt("Re-enter 6 digit pin")||"")!==n){x.error("Pins do not match");return}if(n.length===6){t||(t=crypto.getRandomValues(new Uint32Array(32)).toString());try{return await D(n,{token:t})}catch(r){console.error(r)}}}function B({className:t}){return Ee()?null:e.jsx(ce,{className:"text-danger fixed top-2 right-2 text-2xl z-10 "+t,title:"You are currently offline. It is not recommend to add/edit keys offline to avoid conflicts."})}function at({user:t}){var c;const{value:n,loading:s,error:r,userRef:a}=Me(),[o,i]=u.useState(),[l,f]=u.useState(!1),[d,w]=u.useState(!1);u.useEffect(()=>{const m=()=>{document.visibilityState==="visible"&&i(void 0)};return document.addEventListener("visibilitychange",m),()=>document.removeEventListener("visibilitychange",m)},[]),u.useEffect(()=>{!s&&!r&&(n==null?void 0:n.data())===void 0&&W().then(m=>{m?je(a,{keys:[],email:t.email||"",code:m}):x.error("Failed to create user")})},[n,s,r]);const p=async()=>{if(!confirm("Would you like to update your pin?"))return;const m=await W(o);m?v(a,{code:m}):x.error("Failed to update pin")};return s||r||!n||n.data()===void 0?e.jsxs(N,{children:[r&&e.jsxs("p",{children:["Error: ",r.message]}),!n||n.data()===void 0&&e.jsx("p",{children:"No data"})]}):o?e.jsxs(L.Provider,{value:o,children:[e.jsx(B,{}),e.jsx(We,{lock:()=>i(void 0),updateCode:p,editMode:l,setEditKey:w,setEditMode:f,exportKeys:()=>Pe(o,n.data()),importKeys:()=>Te(o,n.data(),a)}),e.jsx(rt,{userData:n.data(),userRef:a,editMode:l,setEditMode:f,editKey:d,setEditKey:w})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"!bottom-4 !right-5 top-auto"}),e.jsx(Re,{unlock:m=>i(m),encryptedCode:(c=n.data())==null?void 0:c.code})]})}window.global||(window.global=window);globalThis.Buffer=le.Buffer;const it=matchMedia("(display-mode: browser)").matches;it||window.resizeTo(500,760);const H=navigator;H.virtualKeyboard&&(H.virtualKeyboard.overlaysContent=!0);const ct=Le({onNeedRefresh(){x.warn("New version available, tap to update.",{autoClose:!1,onClick:()=>{ct(),x.warn("Updating...",{autoClose:!1})},closeOnClick:!0})}});function lt(){return e.jsxs(u.StrictMode,{children:[e.jsx(ot,{}),e.jsx(ue,{theme:"dark",position:"bottom-center",transition:fe,hideProgressBar:!0,closeButton:!1})]})}de(document.getElementById("root")).render(e.jsx(lt,{}));export{xt as a,pt as c,ht as g};
//# sourceMappingURL=index-1OQT6dGP.js.map
