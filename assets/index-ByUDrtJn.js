function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["/factor/assets/vendor-DiFyTCEx.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as u,u as B,a as ee,B as w,d as k,e as I,j as t,b as te,J as L,F as re,P as se,c as K,f as E,g as ne,h as oe,i as ae,k as ie,l as J,m as ce,n as P,p as W,q as le,s as de,t as ue,T as fe,C as me,v as ge,w as pe,x as he,y as xe,Q as ye,X as we}from"./vendor-DIz_cE_m.js";import{i as be,g as je,a as ve,p as Ae,d as Ce,u as C,b as H,t as ke,c as Se,e as U,s as Ne}from"./firebase-B19angH3.js";import{i as Le,s as Ee,a as Fe}from"./simple-icons-5YJPn3BQ.js";import{z as Ie}from"./qr-scanner-Dr_EAC8n.js";import"./index-ByUDrtJn.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();var Lt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Et(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ft(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var s=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};s.prototype=r.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(s,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}),s}const Me="modulepreload",Te=function(e,r){return e[0]==="."?new URL(e,r).href:e},G={},Pe=function(r,s,n){let o=Promise.resolve();if(s&&s.length>0){const a=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),l=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=Promise.all(s.map(f=>{if(f=Te(f,n),f in G)return;G[f]=!0;const c=f.endsWith(".css"),b=c?'[rel="stylesheet"]':"";if(!!n)for(let m=a.length-1;m>=0;m--){const h=a[m];if(h.href===f&&(!c||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${b}`))return;const i=document.createElement("link");if(i.rel=c?"stylesheet":Me,c||(i.as="script",i.crossOrigin=""),i.href=f,l&&i.setAttribute("nonce",l),document.head.appendChild(i),c)return new Promise((m,h)=>{i.addEventListener("load",m),i.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${f}`)))})}))}return o.then(()=>r()).catch(a=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=a,window.dispatchEvent(d),!d.defaultPrevented)throw a})};function Re(e={}){const{immediate:r=!1,onNeedRefresh:s,onOfflineReady:n,onRegistered:o,onRegisteredSW:a,onRegisterError:d}=e;let l,f,c;const b=async(i=!0)=>{await f,await(c==null?void 0:c())};async function p(){if("serviceWorker"in navigator){if(l=await Pe(()=>import("./vendor-DIz_cE_m.js").then(i=>i.A),__vite__mapDeps([0]),import.meta.url).then(({Workbox:i})=>new i("/factor/sw.js",{scope:"/factor/",type:"classic"})).catch(i=>{d==null||d(i)}),!l)return;c=async()=>{await(l==null?void 0:l.messageSkipWaiting())};{let i=!1;const m=()=>{i=!0,l==null||l.addEventListener("controlling",h=>{h.isUpdate&&window.location.reload()}),s==null||s()};l.addEventListener("installed",h=>{typeof h.isUpdate>"u"?typeof h.isExternal<"u"?h.isExternal?m():!i&&(n==null||n()):h.isExternal?window.location.reload():!i&&(n==null||n()):h.isUpdate||n==null||n()}),l.addEventListener("waiting",m),l.addEventListener("externalwaiting",m)}l.register({immediate:r}).then(i=>{a?a("/factor/sw.js",i):o==null||o(i)}).catch(i=>{d==null||d(i)})}}return f=p(),b}const M=u.createContext(void 0);function De(){const[e,r]=u.useState(navigator.onLine);return u.useEffect(()=>{function s(){r(navigator.onLine)}return window.addEventListener("online",s),window.addEventListener("offline",s),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",s)}},[]),e}const Oe={apiKey:"AIzaSyDMQ4jffBbrLTjdhy_qS4GeZdbYtzEKHp4",authDomain:"factor-97c20.firebaseapp.com",projectId:"factor-97c20",storageBucket:"factor-97c20.appspot.com",messagingSenderId:"524844196447",appId:"1:524844196447:web:9d5f59006ec0b8e68d31ea"},Q=be(Oe),S=je(Q),O=ve(Q,{localCache:Ae()});function ze(){const[e]=B(S),r=Ce(O,"users",(e==null?void 0:e.uid)||""),[s,n,o]=ee(r);return{value:s,loading:n,error:o,userRef:r}}async function Be(e,r){const s=w(`Exporting keys ⏳️
This might take some time...`,{autoClose:!1,progress:1/r.keys.length,hideProgressBar:!1}),n=[];for(let l=0;l<r.keys.length;l++){const f=r.keys[l],c=await k(e,f.secret);n.push({name:f.name,secret:c.secret}),w.update(s,{progress:l/r.keys.length})}w.done(s);const o=new Blob([JSON.stringify(n)],{type:"text/json"}),a=URL.createObjectURL(o),d=document.createElement("a");d.href=a,d.download="keys.json",d.click(),URL.revokeObjectURL(a)}async function We(e,r,s){const n=document.createElement("input");n.type="file",n.addEventListener("change",o=>{if(n.files&&n.files[0]){const a=n.files[0],d=new FileReader;d.onload=async l=>{try{if(l.target){const f=JSON.parse(l.target.result);let c=0,b=0;for(const p of f){if(!p.name||!p.secret)throw"Invalid file format";const i=p.name;if(r.keys.some(m=>m.name.toLowerCase()===i.toLowerCase()))c++;else{const m=await I(e,p.secret);await C(s,{keys:H({name:i,secret:m})}),b++}}c>0&&w.warning(`${c} keys were skipped because they already exist`),b>0&&w.success(`Imported ${f.length-c} keys`)}}catch(f){console.error(f),w.error(f||"Error importing keys")}},d.readAsText(a)}}),n.click()}var N=(e=>(e.Linux="Linux",e.Mac="Mac",e.Windows="Windows",e.iOS="iOS",e.Android="Android",e.Other="Other",e))(N||{});function He(){const e=navigator.userAgent;return e.includes("iPhone")||e.includes("iPad")||e.includes("iPod")?"iOS":e.includes("Android")?"Android":e.includes("Mac")?"Mac":e.includes("Win")?"Windows":e.includes("Linux")?"Linux":"Other"}const X="device-uuid";function Ue(){let e=localStorage.getItem(X);return e||(e=crypto.getRandomValues(new Uint32Array(32)).toString(),localStorage.setItem(X,e)),e}const _=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32)));async function Ke(){try{const e=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32))),r=S.currentUser,s={challenge:_,rp:{name:"Factor"},user:{id:e,name:(r==null?void 0:r.email)||"user@email.com",displayName:(r==null?void 0:r.displayName)||"User"},pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{requireResidentKey:!0}},n=await navigator.credentials.create({publicKey:s});return{userHandle:z(e),credentialId:z(n.rawId)}}catch(e){console.error("Error registering credential:",e)}return null}async function Ge(e){try{const r=Ze(e),s={challenge:_,allowCredentials:[{type:"public-key",id:r}]},n=await navigator.credentials.get({publicKey:s});if(n!=null&&n.response)return z(n.response.userHandle)}catch(r){console.error("Error authenticating:",r)}return null}function Xe(e){const r=new Uint8Array(e),s=Array.from(r);return String.fromCharCode.apply(null,s)}function z(e){return btoa(Xe(e))}function Ze(e){const r=atob(e),s=r.length,n=new ArrayBuffer(s),o=new Uint8Array(n);for(let a=0;a<s;a++)o[a]=r.charCodeAt(a);return n}const Ye="/factor/assets/logo-lomxQ9_I.png";function qe({className:e}){return t.jsx("img",{src:Ye,className:"h-52 "+e})}function F({className:e,children:r,...s}){return t.jsxs("div",{className:"w-screen h-[100svh] flex flex-col justify-center items-center gap-5",...s,children:[t.jsx("h1",{className:"text-center m-0 -mb-1",children:"Factor"}),t.jsx(qe,{className:e}),r,t.jsx("span",{className:"text-[8px] absolute bottom-1.5 right-1.5 whitespace-pre text-right",children:new Date("2024-04-15T17:00:18.041Z").toLocaleString().replace(", ",`
`)})]})}let R=!1;function Ve({unlock:e,encryptedCode:r,data:s,userRef:n}){var h;const o=u.useRef(null),[a]=te(S),d=Ue(),l=He(),f=navigator.credentials&&(l===N.Android||l===N.iOS||l===N.Mac||!1),c=(h=s==null?void 0:s.webauthn)==null?void 0:h.find(g=>g.uuid===d);u.useEffect(()=>{setTimeout(()=>{var g;return(g=o.current)==null?void 0:g[0].focus()},250)},[]),u.useEffect(()=>{c&&!R&&(p(),R=!0)},[c]);const b=L(()=>{c&&confirm("Reset Biometric Auth?")&&C(n,{webauthn:U({...c})})},{threshold:3e3,onCancel:(g,{reason:x})=>{x===E.CancelledByRelease&&p()}}),p=async()=>{try{if(!c)throw"webauthn not defined";const g=await Ge(c.credentialId).catch(console.error),x=await k(g||"",c.secret);e(x.token)}catch(g){console.error(g),w.error("Invalid biometric login")}},i=async()=>{try{const g=prompt("Enter pin to register biometric login")||"",x=await k(g,r),v=await Ke(),y=(v==null?void 0:v.userHandle)||"",j=await I(y,x);C(n,{webauthn:H({credentialId:v==null?void 0:v.credentialId,uuid:d,secret:j,userAgent:navigator.userAgent})}),R=!0,w.success("Successfully enrolled biometric login")}catch(g){console.error(g),w.error("Error registering fingerprint")}},m=async g=>{if((g==null?void 0:g.length)===6)try{const x=await k(g,r);e(x.token)}catch(x){console.log(x,g),w.error("Invalid code")}o.current&&(o.current.forEach(x=>{x.value=""}),o.current[0].focus())};return t.jsxs(F,{onClick:g=>{var v;const x=(v=g.target)==null?void 0:v.nodeName;o.current&&(x==="DIV"||x==="IMG"||x==="H1")&&o.current[0].focus()},style:{marginTop:"calc(-1 * env(keyboard-inset-height) / 2)"},children:[t.jsx("button",{className:"icon fixed top-4 right-4 bg-danger",onClick:async()=>{try{await a(),await ke(O),await Se(O),window.location.reload()}catch(g){console.error(g)}},children:t.jsx(re,{})}),t.jsx("div",{className:"flex mb-6",children:t.jsx(se,{length:6,className:"border border-slate-500 w-10 sm:w-12 h-14 m-1.5 rounded-lg text-center text-6xl p-1",type:"password",inputMode:"numeric",ref:o,onComplete:m})}),f&&(c?t.jsx("button",{className:"p-3 rounded-full bg-slate-900 bg-opacity-75 border-2 border-slate-600",...b(),children:t.jsx(K,{size:30})}):t.jsx("button",{className:"p-3 rounded-full bg-tertiary bg-opacity-75 border-2 border-slate-600",onClick:i,children:t.jsx(K,{size:30})}))]})}function Je(){const[e]=B(S),[r,,s,n]=ne(S);return t.jsxs("div",{className:"flex justify-center items-center flex-col",children:[!e&&!s&&t.jsx(Qe,{signin:()=>r()}),s&&t.jsx("p",{children:"Loading..."}),n&&t.jsxs("p",{children:["Error: ",n.message]})]})}function Qe({signin:e}){return t.jsxs("button",{className:"gsi-material-button",onClick:e,children:[t.jsx("div",{className:"gsi-material-button-state"}),t.jsxs("div",{className:"gsi-material-button-content-wrapper",children:[t.jsx("div",{className:"gsi-material-button-icon",children:t.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",style:{display:"block"},children:[t.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),t.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),t.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),t.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),t.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),t.jsx("span",{className:"gsi-material-button-contents",children:"Sign in with Google"}),t.jsx("span",{style:{display:"none"},children:"Sign in with Google"})]})]})}function _e({lock:e,updateCode:r,editMode:s,setEditMode:n,setEditKey:o,exportKeys:a,importKeys:d}){const l="p-4 rounded-full",f=l+" !bg-slate-800 !text-primary",c=L(r,{threshold:600,onCancel:(p,{reason:i})=>{i===E.CancelledByRelease&&e()}}),b=L(()=>{n(!0)},{threshold:600,onCancel:(p,{reason:i})=>{i===E.CancelledByRelease&&(s?n(!1):setTimeout(()=>o(!0),10))}});return t.jsxs("div",{className:"fixed bottom-8 right-8 flex gap-4 z-20",children:[s&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:f,onClick:()=>d(),children:t.jsx(oe,{})}),t.jsx("button",{className:f+" mr-4",onClick:()=>a(),children:t.jsx(ae,{})})]}),t.jsx("button",{className:f+(s?" rotate-45":""),...b(),children:t.jsx(ie,{})}),t.jsx("button",{className:"transition-transform "+l,...c(),children:t.jsx(J,{})})]})}function $e(){const[e,r]=u.useState(new Date),[s,n]=u.useState(new Date);return u.useEffect(()=>{const o=setInterval(()=>n(new Date),1e3);let a;return setTimeout(()=>{r(new Date),a=setInterval(()=>r(new Date),3e4)},3e4-new Date().getTime()%3e4),()=>{a&&clearInterval(a),clearInterval(o)}},[]),{time:s,timestamp:e}}const Z={content:["./index.html","./src/**/*.{js,ts,jsx,tsx}"],theme:{extend:{colors:{primary:"#4b888d",secondary:"#051524",tertiary:"#2c2155",danger:"#f07f7b"},keyframes:{wiggle:{"0%, 100%":{transform:"rotate(-0.5deg)"},"50%":{transform:"rotate(0.5deg)"}}},animation:{wiggle:"wiggle 400ms ease-in-out infinite"}}},plugins:[]};function et(){return u.useMemo(()=>ce(Z),[Z])}const tt="/factor/assets/bastillion-C8U43q6p.png",rt="/factor/assets/betterment-qyE9Qf23.png",st="data:image/png;base64,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",nt="/factor/assets/guideline-BzofyXre.png",ot="/factor/assets/id.me-DKMQt8CE.png",at="/factor/assets/justworks-GR0TnuZp.jpg",it="/factor/assets/uwcu-Cguu5ZT9.png";function ct(e){if(!e)return;let r=Object.entries(Le).filter(s=>e.toLowerCase().includes(s[1].title.toLowerCase())&&P(e.toLowerCase(),s[1].title.toLowerCase())<e.length/2).sort((s,n)=>P(e.toLowerCase(),s[1].title.toLowerCase())-P(e.toLowerCase(),n[1].title.toLowerCase()))[0];switch(e.toLowerCase()){case"bastillion":return{url:tt,padding:!0,type:"Image"};case"betterment":return{url:rt,type:"Image"};case"carta":return{url:st,type:"Image"};case"facebook":return{...Fe,padding:!1,type:"Icon"};case"guideline":return{url:nt,type:"Image"};case"id.me":return{url:ot,type:"Image"};case"justworks":return{url:at,type:"Image"};case"nas":return{...Ee,type:"Icon"};case"uw credit union":case"uwcu":return{url:it,padding:!0,type:"Image"}}return r?{...r[1],type:"Icon",padding:!0}:void 0}const D="bg-slate-900",lt="bg-slate-800";function dt(e){if(!e||e.type==="Image")return{background:D,fill:lt};const r=e;let s=D,n="#"+r.hex;switch(r.title.toLowerCase()){case"amazon":s=D;break;case"microsoft":n="#00a2ed";break;case"github":case"patreon":case"ubisoft":s="bg-slate-100";break}return{background:s,fill:n}}function $({name:e,className:r}){const s=ct(e),n=dt(s),o="w-12 h-12 rounded-full border border-slate-400 flex justify-center items-center aspect-square "+n.background+" "+r;return s?s.type==="Image"?t.jsx("img",{src:s.url,className:o+` object-cover ${s.padding?"p-1":""}`}):t.jsx("div",{dangerouslySetInnerHTML:{__html:s.svg},className:`${o} ${s.padding?"p-2.5":"p-0.5"}`,style:{fill:n.fill}}):t.jsx("div",{className:o,children:t.jsx(J,{})})}function ut({close:e,onScan:r}){return t.jsx("div",{className:"absolute inset-0 w-screen h-screen bg-black flex justify-center z-10",children:t.jsxs("div",{className:"relative w-[100vh] p-2",children:[t.jsx("div",{className:"absolute bottom-14 right-0 left-0 z-10 flex justify-center",children:t.jsx("button",{className:"icon",onClick:e,children:t.jsx(W,{})})}),t.jsx(Ie,{onResult:async s=>{try{const n=new URL(s),o=decodeURIComponent(n.pathname.replace("//totp/","")).split(":")[0],a=n.searchParams.get("secret");if(n.protocol!=="otpauth:"||!o||!a)throw new Error(`Invalid URL: ${n.toString()}`);r(o,a),e()}catch(n){console.error(n),w.error("Failed to scan qr code")}},onError:s=>console.error(s==null?void 0:s.message),components:{audio:!1}})]})})}function ft(e){const[r,s]=u.useState(e.name||""),[n,o]=u.useState(e.secret||""),[a,d]=u.useState(!1),[l,f]=u.useState(!0),[c,b]=u.useState(!1),p=u.useContext(M)||"",i=e.name||e.secret,m=async(h,g)=>{if(h===""||g===""){w.error("Name and secret are required");return}try{b(!0),i&&(e.name!==h||e.secret!==g)&&await C(e.userRef,{keys:U({name:e.name,secret:e.secret})});const x=await I(p,{secret:g});await C(e.userRef,{keys:H({name:h,secret:x})}),s(""),o(""),f(!0),e.close()}catch(x){console.error(x),w.error("Failed to add key")}finally{b(!1)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col gap-8",onKeyDown:h=>{h.key==="Enter"&&m(r,n)},children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx($,{name:r,className:"w-14 h-14 sm:w-16 sm:h-16"}),t.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[t.jsx("input",{value:r,onChange:h=>s(h.target.value),placeholder:"Site name",autoFocus:!0,autoComplete:"false",type:"text"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{value:n,onChange:h=>o(h.target.value),placeholder:"Secret",autoComplete:"false",type:l?"password":"text"}),t.jsx("button",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer bg-transparent",onClick:()=>f(!l),children:l?t.jsx(le,{}):t.jsx(de,{})})]})]})]}),t.jsxs("div",{className:"flex gap-4",children:[!i&&t.jsx("button",{onClick:()=>d(!0),children:t.jsx(ue,{})}),t.jsx("button",{onClick:()=>m(r,n),className:"flex-1",disabled:c,children:c?i?"Saving":"Adding":i?"Save":"Add"})]})]}),a&&t.jsx(ut,{close:()=>d(!1),onScan:(h,g)=>{s(h),o(g)}})]})}function mt({onClose:e,title:r,children:s}){return t.jsx("div",{className:"fixed z-10 inset-0 bg-slate-900 bg-opacity-75 flex justify-center items-center",onClick:e,onKeyDown:n=>{n.key==="Escape"&&e()},children:t.jsxs("div",{className:"bg-slate-700 rounded-lg p-8 w-full",onClick:n=>n.stopPropagation(),style:{marginTop:"calc(-1 * env(keyboard-inset-height))",maxWidth:"min(80vw, 600px)"},children:[t.jsxs("div",{className:"flex items-center mb-8",children:[t.jsx("h2",{className:"flex-1 text-xl font-medium",children:r}),t.jsx("button",{onClick:e,className:"px-2 bg-slate-600 border-2 border-slate-800",children:t.jsx(W,{})})]}),s]})})}function gt(){const[e,r]=u.useState(null);return[u.useCallback(async n=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(n),r(n),!0}catch(o){return console.warn("Copy failed",o),r(null),!1}},[]),e]}function pt(){const[e,r]=u.useState(!1);return u.useEffect(()=>{const s=()=>{r(window.innerWidth<500)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),e}function ht({data:e,userRef:r,timestamp:s,onEdit:n,setEditMode:o,editMode:a}){const d=u.useContext(M)||"",[l,f]=u.useState(""),[c,b]=u.useState(0),p=pt(),[i]=gt(),m=()=>{a?n():c===0?b(1):v()},h=L(()=>o(!a),{threshold:600,onCancel:(y,{reason:j})=>{j===E.CancelledByRelease&&m()}});u.useEffect(()=>{c!==0&&k(d,e.secret).then(y=>f(y.secret)).catch(y=>{console.error(y),f("Error")})},[e.secret,d,c]);const g=Math.floor(s.getTime()/3e4),x=u.useMemo(()=>{if(l.length===0||l==="Error"||c===0)return"Token Error";try{return fe.generate(l.replace(/\s+/g,""),{timestamp:g*3e4}).otp}catch(y){return console.error(y),"Token Error"}},[l,g,c]),v=u.useCallback(()=>i(x).then(y=>{y&&x!=="Token Error"?w.success(e.name+" code copied",{bodyClassName:p?"text-right":"",autoClose:2500}):w.error("Failed to copy code",{autoClose:2500})}),[x,e,p,i]);return u.useEffect(()=>{c===1&&x!=="Token Error"&&(v(),b(2))},[c,x]),t.jsxs("div",{className:"p-3 bg-slate-800 border border-slate-700 rounded-md select-none flex gap-6 justify-between items-center hover:brightness-[90%] relative cursor-pointer transition-all rotate-0"+(a?" animate-wiggle":""),style:{animationDelay:`${Math.random()*250}ms`},tabIndex:0,...h(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&m()},children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx($,{name:e.name}),t.jsxs("div",{className:"flex flex-col items-start justify-center",children:[t.jsx("h2",{className:"font-bold capitalize",children:e.name}),t.jsx("div",{children:c===0?"*** ***":l.length===0?"Decrypting...":x==="Token Error"?"Token Error":t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2",children:x.slice(0,3)}),t.jsx("span",{children:x.slice(3,6)})]})})]})]}),t.jsx("button",{className:"absolute -top-3 -right-3 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full hover:text-white hover:brightness-100 sm:hover:bg-danger transition-all duration-300",style:{pointerEvents:a?"auto":"none",opacity:a?1:0},tabIndex:a?0:-1,onClick:y=>{y.stopPropagation(),window.confirm(`Are you sure you want to remove ${e.name}? This cannot be undone!`)&&window.confirm("Are you really sure?")&&C(r,{keys:U(e)})},onMouseDown:y=>y.stopPropagation(),onTouchStart:y=>y.stopPropagation(),onPointerDown:y=>y.stopPropagation(),children:t.jsx(W,{})})]})}function xt({userData:e,userRef:r,editMode:s,setEditMode:n,editKey:o,setEditKey:a}){const{time:d,timestamp:l}=$e(),f=u.useContext(M)||"",[c,b]=u.useState(""),[p,i]=u.useState(),m=et(),h=3e4-d.getTime()%3e4,g=Math.ceil(h/1e3),x=30-g;u.useEffect(()=>()=>{n(!1),a(!1)},[]),u.useEffect(()=>{s&&navigator.vibrate&&navigator.vibrate(200)},[s]);const v=u.useMemo(()=>t.jsxs(t.Fragment,{children:[e.keys.length===0&&t.jsx("div",{className:"text-center text-lg bg-slate-800 p-8 w-full rounded-md",children:"No keys added yet"}),e.keys.length>0&&t.jsxs("div",{className:"w-full max-w-screen-lg",children:[t.jsxs("div",{className:"relative",children:[t.jsx("input",{className:"mb-6 pl-10",type:"search",value:c,placeholder:"Search tokens",onChange:j=>b(j.target.value)}),t.jsx("svg",{className:"fill-slate-400 absolute left-3 top-[11px] h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:t.jsx("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})})]}),t.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",children:e.keys.filter(j=>c.length===0||j.name.toLowerCase().includes(c.toLowerCase())).sort((j,A)=>j.name.localeCompare(A.name)).map(j=>{try{return t.jsx(ht,{data:j,userRef:r,timestamp:l,onEdit:()=>{const A=w.info("Decrypting token...",{autoClose:1500});k(f,j.secret).then(T=>{w.dismiss(A),a(!0),i({name:j.name,secret:T.secret})}).catch(T=>{w.dismiss(A),console.error(T),w.error("Failed to decrypt token",{autoClose:2500})})},setEditMode:n,editMode:s},j.name)}catch(A){return console.error(A),t.jsxs("div",{children:["Error Loading Token (",j.name,")"]})}})})]})]}),[e.keys,c,l,r,s]),y=(x+.15)/29.4*50;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex sm:justify-center pl-8 sm:pl-0 fixed bottom-0 left-0 right-0 z-10 backdrop-blur-lg bg-slate-900 bg-opacity-30 pt-4 border-t-2 border-secondary",children:[t.jsx("div",{className:"w-16 h-16 p-1 mb-6",children:t.jsx(me,{value:g-1,maxValue:30,text:g.toString(),styles:ge({textSize:"40px",trailColor:m.theme.colors.slate[700],textColor:m.theme.colors.primary,pathColor:m.theme.colors.primary}),strokeWidth:10})}),t.jsx("div",{className:"fixed bottom-1 h-1.5 bg-primary transition-all duration-700 z-20 rounded",style:{left:`${y}%`,right:`${y}%`}})]}),t.jsx("div",{className:"flex flex-col gap-4 m-6 sm:m-8 items-center pb-24",children:v}),o&&t.jsx(mt,{title:p!=null&&p.name||p!=null&&p.secret?"Edit existing key":"Add a new key",onClose:()=>{a(!1),i(void 0)},children:t.jsx(ft,{name:p==null?void 0:p.name,secret:p==null?void 0:p.secret,userRef:r,close:()=>{a(!1),i(void 0)}})})]})}function yt(){const[e,r,s]=B(S);return r||s?t.jsx(F,{children:s&&t.jsxs("p",{children:["Error: ",s.message]})}):e?t.jsx(wt,{user:e}):t.jsx(F,{children:t.jsx(Je,{})})}async function Y(e){let r="",s=0;for(;r.length!==6&&s<3;)r=prompt("Set a new 6 digit pin")||"",s++;if(r.length===6&&(prompt("Re-enter 6 digit pin")||"")!==r){w.error("Pins do not match");return}if(r.length===6){e||(e=crypto.getRandomValues(new Uint32Array(32)).toString());try{return await I(r,{token:e})}catch(n){console.error(n)}}}function q({className:e}){return De()?null:t.jsx(pe,{className:"text-danger fixed top-2 right-2 text-2xl z-10 "+e,title:"You are currently offline. It is not recommend to add/edit keys offline to avoid conflicts."})}function wt({user:e}){var i;const{value:r,loading:s,error:n,userRef:o}=ze(),[a,d]=u.useState(),[l,f]=u.useState(!1),[c,b]=u.useState(!1);u.useEffect(()=>{const m=()=>{document.visibilityState==="visible"&&d(void 0)};return document.addEventListener("visibilitychange",m),()=>document.removeEventListener("visibilitychange",m)},[]),u.useEffect(()=>{!s&&!n&&(r==null?void 0:r.data())===void 0&&Y().then(m=>{m?Ne(o,{keys:[],email:e.email||"",code:m,webauthn:[]}):w.error("Failed to create user")})},[r,s,n]);const p=async()=>{if(!confirm("Would you like to update your pin?"))return;const m=await Y(a);m?C(o,{code:m}):w.error("Failed to update pin")};return s||n||!r||r.data()===void 0?t.jsxs(F,{children:[n&&t.jsxs("p",{children:["Error: ",n.message]}),!r||r.data()===void 0&&t.jsx("p",{children:"No data"})]}):a?t.jsxs(M.Provider,{value:a,children:[t.jsx(q,{}),t.jsx(_e,{lock:()=>d(void 0),updateCode:p,editMode:l,setEditKey:b,setEditMode:f,exportKeys:()=>Be(a,r.data()),importKeys:()=>We(a,r.data(),o)}),t.jsx(xt,{userData:r.data(),userRef:o,editMode:l,setEditMode:f,editKey:c,setEditKey:b})]}):t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"!bottom-4 !right-5 top-auto"}),t.jsx(Ve,{unlock:m=>d(m),encryptedCode:(i=r.data())==null?void 0:i.code,data:r.data(),userRef:o})]})}window.global||(window.global=window);globalThis.Buffer=he.Buffer;const bt=matchMedia("(display-mode: browser)").matches;bt||window.resizeTo(500,760);const V=navigator;V.virtualKeyboard&&(V.virtualKeyboard.overlaysContent=!0);const jt=Re({onNeedRefresh(){w.warn("New version available, tap to update.",{autoClose:!1,onClick:()=>{jt(),w.warn("Updating...",{autoClose:!1})},closeOnClick:!0})}});function vt(){return t.jsxs(u.StrictMode,{children:[t.jsx(yt,{}),t.jsx(ye,{theme:"dark",position:"bottom-center",transition:we,hideProgressBar:!0,closeButton:!1})]})}xe(document.getElementById("root")).render(t.jsx(vt,{}));export{Ft as a,Lt as c,Et as g};
//# sourceMappingURL=index-ByUDrtJn.js.map
