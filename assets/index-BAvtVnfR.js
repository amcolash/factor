function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["/factor/assets/vendor-DiFyTCEx.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{r as f,B as h,u as z,a as ne,d as N,e as I,j as t,t as C,b as O,c as re,F as oe,P as ae,f as Y,J as ie,g as ce,h as le,i as ue,k as de,l as fe,m as J,n as me,p as D,q as B,s as ge,v as pe,w as he,T as xe,C as ye,x as we,y as be,z as je,A as ve,Q as Ae,X as Ce}from"./vendor-Cf38rcTl.js";import{i as ke,g as Ne,a as Se,p as Le,d as Ee,u as A,b as W,t as Ie,c as Fe,e as H,s as Te}from"./firebase-BB74bVqX.js";import{i as De,s as Me,a as Pe}from"./simple-icons-5YJPn3BQ.js";import{z as Re}from"./qr-scanner-RsSChKsY.js";import"./index-BAvtVnfR.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zt(e){if(e.__esModule)return e;var s=e.default;if(typeof s=="function"){var n=function r(){return this instanceof r?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};n.prototype=s.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return e[r]}})}),n}const F=f.createContext(void 0);function ze(){const[e,s]=f.useState(navigator.onLine);return f.useEffect(()=>{function n(){s(navigator.onLine)}return window.addEventListener("online",n),window.addEventListener("offline",n),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",n)}},[]),e}const Oe="modulepreload",Be=function(e,s){return e[0]==="."?new URL(e,s).href:e},U={},We=function(s,n,r){let o=Promise.resolve();if(n&&n.length>0){const a=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),c=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.all(n.map(l=>{if(l=Be(l,r),l in U)return;U[l]=!0;const u=l.endsWith(".css"),x=u?'[rel="stylesheet"]':"";if(!!r)for(let m=a.length-1;m>=0;m--){const g=a[m];if(g.href===l&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${x}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Oe,u||(d.as="script",d.crossOrigin=""),d.href=l,c&&d.setAttribute("nonce",c),document.head.appendChild(d),u)return new Promise((m,g)=>{d.addEventListener("load",m),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}return o.then(()=>s()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};function He(e={}){const{immediate:s=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:o,onRegisteredSW:a,onRegisterError:i}=e;let c,l,u;const x=async(d=!0)=>{await l,await(u==null?void 0:u())};async function p(){if("serviceWorker"in navigator){if(c=await We(()=>import("./vendor-Cf38rcTl.js").then(d=>d.E),__vite__mapDeps([0]),import.meta.url).then(({Workbox:d})=>new d("/factor/sw.js",{scope:"/factor/",type:"classic"})).catch(d=>{i==null||i(d)}),!c)return;u=async()=>{await(c==null?void 0:c.messageSkipWaiting())};{let d=!1;const m=()=>{d=!0,c==null||c.addEventListener("controlling",g=>{g.isUpdate&&window.location.reload()}),n==null||n()};c.addEventListener("installed",g=>{typeof g.isUpdate>"u"?typeof g.isExternal<"u"?g.isExternal?m():!d&&(r==null||r()):g.isExternal?window.location.reload():!d&&(r==null||r()):g.isUpdate||r==null||r()}),c.addEventListener("waiting",m),c.addEventListener("externalwaiting",m)}c.register({immediate:s}).then(d=>{a?a("/factor/sw.js",d):o==null||o(d)}).catch(d=>{i==null||i(d)})}}return l=p(),x}function Ue(){let e;const s=He({onNeedRefresh(){const n="New version installed, tap to update.",r={autoClose:!1,closeOnClick:!0,onClick:()=>{const o="Updating...";e?h.update(e,{render:o,onClick:void 0}):h.warn(o,{autoClose:!1}),s()}};e?h.update(e,{render:n,type:"warning",...r}):e=h.warn(n,r)},onRegistered(n){n&&(setInterval(()=>{n.update()},3e5),n.addEventListener("updatefound",()=>{e=h.info("Downloading new version...")}))}})}const Ke={apiKey:"AIzaSyDMQ4jffBbrLTjdhy_qS4GeZdbYtzEKHp4",authDomain:"factor-97c20.firebaseapp.com",projectId:"factor-97c20",storageBucket:"factor-97c20.appspot.com",messagingSenderId:"524844196447",appId:"1:524844196447:web:9d5f59006ec0b8e68d31ea"},Q=ke(Ke),k=Ne(Q),P=Se(Q,{localCache:Le()});function Ge(){const[e]=z(k),s=Ee(P,"users",(e==null?void 0:e.uid)||""),[n,r,o]=ne(s);return{value:n,loading:r,error:o,userRef:s}}function _(e){f.useEffect(()=>{const s=()=>e(!document.hidden);return document.addEventListener("visibilitychange",s),()=>document.removeEventListener("visibilitychange",s)},[e])}async function Xe(e,s){const n=h(`Exporting keys ⏳️
This might take some time...`,{autoClose:!1,progress:1/s.keys.length,hideProgressBar:!1}),r=[];for(let c=0;c<s.keys.length;c++){const l=s.keys[c],u=await N(e,l.secret);r.push({name:l.name,secret:u.secret}),h.update(n,{progress:c/s.keys.length})}h.done(n);const o=new Blob([JSON.stringify(r)],{type:"text/json"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download="keys.json",i.click(),URL.revokeObjectURL(a)}async function Ze(e,s,n){const r=document.createElement("input");r.type="file",r.addEventListener("change",o=>{if(r.files&&r.files[0]){const a=r.files[0],i=new FileReader;i.onload=async c=>{try{if(c.target){const l=JSON.parse(c.target.result);let u=0,x=0;for(const p of l){if(!p.name||!p.secret)throw"Invalid file format";const d=p.name;if(s.keys.some(m=>m.name.toLowerCase()===d.toLowerCase()))u++;else{const m=await I(e,p.secret);await A(n,{keys:W({name:d,secret:m})}),x++}}u>0&&h.warning(`${u} keys were skipped because they already exist`),x>0&&h.success(`Imported ${l.length-u} keys`)}}catch(l){console.error(l),h.error(l||"Error importing keys")}},i.readAsText(a)}}),r.click()}const K="device-uuid";function $(){let e=localStorage.getItem(K);return e||(e=crypto.getRandomValues(new Uint32Array(32)).toString(),localStorage.setItem(K,e)),e}const ee="/factor/assets/logo-lomxQ9_I.png";function qe({className:e}){return t.jsx("img",{src:ee,className:O("h-52",e)})}function L({className:e,children:s,...n}){return t.jsxs("div",{className:"w-screen h-[100svh] flex flex-col justify-center items-center gap-5",...n,children:[t.jsx("h1",{className:"text-center m-0 -mb-1",children:"Factor"}),t.jsx(qe,{className:e}),s,t.jsx("span",{className:C("absolute bottom-1.5 right-2 leading-tight whitespace-pre text-right","text-[8px]"),children:new Date("2024-05-05T06:10:01.004Z").toLocaleString().replace(", ",`
`)})]})}function Ve(){const[e]=re(k);return t.jsx("button",{className:"icon bg-danger",onClick:async()=>{try{await e(),await Ie(P),await Fe(P),window.location.reload()}catch(s){console.error(s)}},children:t.jsx(oe,{})})}function Ye({pinRef:e,encryptedCode:s,unlock:n,className:r}){f.useEffect(()=>{setTimeout(()=>{var a;return(a=e.current)==null?void 0:a[0].focus()},250)},[]);const o=async a=>{if((a==null?void 0:a.length)===6)try{const i=await N(a,s);n(i.token)}catch(i){console.log(i,a),h.error("Invalid code")}e.current&&(e.current.forEach(i=>{i.value=""}),e.current[0].focus())};return t.jsx("div",{className:O("flex",r),children:t.jsx(ae,{length:6,className:"border border-slate-500 w-10 sm:w-12 h-14 m-1.5 rounded-lg text-center text-6xl p-1",type:"password",inputMode:"numeric",ref:e,onComplete:o})})}const te=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32)));async function Je(){try{const e=Uint8Array.from(window.crypto.getRandomValues(new Uint8Array(32))),s=k.currentUser,n={challenge:te,rp:{name:"Factor"},user:{id:e,name:(s==null?void 0:s.email)||"user@email.com",displayName:(s==null?void 0:s.displayName)||"User"},pubKeyCredParams:[{type:"public-key",alg:-7}],authenticatorSelection:{requireResidentKey:!0}},r=await navigator.credentials.create({publicKey:n});return{userHandle:R(e),credentialId:R(r.rawId)}}catch(e){console.error("Error registering credential:",e)}return null}async function Qe(e){try{const s=$e(e),n={challenge:te,allowCredentials:[{type:"public-key",id:s}]},r=await navigator.credentials.get({publicKey:n});if(r!=null&&r.response)return R(r.response.userHandle)}catch(s){console.error("Error authenticating:",s)}return null}function _e(e){const s=new Uint8Array(e),n=Array.from(s);return String.fromCharCode.apply(null,n)}function R(e){return btoa(_e(e))}function $e(e){const s=atob(e),n=s.length,r=new ArrayBuffer(n),o=new Uint8Array(r);for(let a=0;a<n;a++)o[a]=s.charCodeAt(a);return r}function et({userRef:e,encryptedCode:s}){const n=$(),r=async()=>{try{const o=prompt("Enter pin to register biometric login")||"",a=await N(o,s),i=await Je(),c=(i==null?void 0:i.userHandle)||"",l=await I(c,a);A(e,{webauthn:W({credentialId:i==null?void 0:i.credentialId,uuid:n,secret:l,userAgent:navigator.userAgent})}),h.success("Successfully enrolled biometric login")}catch(o){console.error(o),h.error("Error registering fingerprint")}};return t.jsx("button",{className:"icon bg-primary text-slate-200",onClick:r,children:t.jsx(Y,{})})}const G=new Set;function tt(e,s){f.useEffect(()=>{G.has(e)||(s(),G.add(e))},[])}function E(e,s,n=600){const r=ie(e,{threshold:n,onCancel:(o,{reason:a})=>{a===ce.CancelledByRelease&&s()}});return()=>({onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&e()},...r()})}function st({webauthn:e,userRef:s,unlock:n}){_(a=>{a&&e&&o()}),tt("webauthn",()=>{e&&o()});const r=E(()=>{e&&confirm("Reset Biometric Auth?")&&A(s,{webauthn:H({...e})})},()=>o(),3e3),o=async()=>{try{if(!e)throw"webauthn not defined";const a=await Qe(e.credentialId).catch(console.error),i=await N(a||"",e.secret);n(i.token)}catch(a){console.error(a),h.error("Invalid biometric login")}};return t.jsx("button",{className:"p-3 rounded-full bg-tertiary text-slate-200 border-2 border-slate-600",...r(),children:t.jsx(Y,{size:30})})}function nt({unlock:e,encryptedCode:s,data:n,userRef:r}){var c;const o=f.useRef(null),a=$(),i=(c=n==null?void 0:n.webauthn)==null?void 0:c.find(l=>l.uuid===a);return t.jsxs(L,{onClick:l=>{var x;const u=(x=l.target)==null?void 0:x.nodeName;o.current&&(u==="DIV"||u==="IMG"||u==="H1")&&o.current[0].focus()},style:{marginTop:"calc(-1 * env(keyboard-inset-height) / 2)"},children:[t.jsxs("div",{className:"flex fixed top-4 right-4 gap-2",children:[!i&&t.jsx(et,{encryptedCode:s,userRef:r}),t.jsx(Ve,{})]}),t.jsx(Ye,{pinRef:o,encryptedCode:s,unlock:e}),i&&t.jsx(st,{unlock:e,userRef:r,webauthn:i})]})}function rt(){const[e]=z(k),[s,,n,r]=le(k);return t.jsxs("div",{className:"flex justify-center items-center flex-col",children:[!e&&!n&&t.jsx(ot,{signin:()=>s()}),n&&t.jsx("p",{children:"Loading..."}),r&&t.jsxs("p",{children:["Error: ",r.message]})]})}function ot({signin:e}){return t.jsxs("button",{className:"gsi-material-button",onClick:e,children:[t.jsx("div",{className:"gsi-material-button-state"}),t.jsxs("div",{className:"gsi-material-button-content-wrapper",children:[t.jsx("div",{className:"gsi-material-button-icon",children:t.jsxs("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48",style:{display:"block"},children:[t.jsx("path",{fill:"#EA4335",d:"M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"}),t.jsx("path",{fill:"#4285F4",d:"M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"}),t.jsx("path",{fill:"#FBBC05",d:"M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"}),t.jsx("path",{fill:"#34A853",d:"M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"}),t.jsx("path",{fill:"none",d:"M0 0h48v48H0z"})]})}),t.jsx("span",{className:"gsi-material-button-contents",children:"Sign in with Google"}),t.jsx("span",{style:{display:"none"},children:"Sign in with Google"})]})]})}function at({lock:e,updateCode:s,editMode:n,setEditMode:r,setEditKey:o,exportKeys:a,importKeys:i}){const c="p-4 rounded-full ",l=c+" !bg-slate-800 !text-primary",u=E(s,e),x=E(()=>r(!n),()=>{n?r(!1):o(!0)});return t.jsxs("div",{className:"fixed bottom-8 right-8 flex gap-4 z-20",children:[n&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:l,onClick:()=>i(),children:t.jsx(ue,{})}),t.jsx("button",{className:l+" mr-4",onClick:()=>a(),children:t.jsx(de,{})})]}),t.jsx("button",{className:C(l,n&&"rotate-45"),...x(),children:t.jsx(fe,{})}),t.jsx("button",{className:C("transition-transform",c),...u(),children:t.jsx(J,{})})]})}function it(){const[e,s]=f.useState(new Date),[n,r]=f.useState(new Date);return f.useEffect(()=>{const o=setInterval(()=>r(new Date),1e3);let a;return setTimeout(()=>{s(new Date),a=setInterval(()=>s(new Date),3e4)},3e4-new Date().getTime()%3e4),()=>{a&&clearInterval(a),clearInterval(o)}},[]),{time:n,timestamp:e}}const X={content:["./index.html","./src/**/*.{js,ts,jsx,tsx}"],theme:{extend:{colors:{primary:"#4b888d",secondary:"#051524",tertiary:"#2c2155",danger:"#f07f7b"},keyframes:{wiggle:{"0%, 100%":{transform:"rotate(-0.5deg)"},"50%":{transform:"rotate(0.5deg)"}}},animation:{wiggle:"wiggle 400ms ease-in-out infinite"}}},plugins:[]};function ct(){return f.useMemo(()=>me(X),[X])}const lt="/factor/assets/bastillion-C8U43q6p.png",ut="/factor/assets/betterment-qyE9Qf23.png",dt="data:image/png;base64,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",ft="/factor/assets/guideline-BzofyXre.png",mt="/factor/assets/id.me-DKMQt8CE.png",gt="/factor/assets/justworks-GR0TnuZp.jpg",pt="/factor/assets/uwcu-Cguu5ZT9.png";function ht(e){if(!e)return;let s=Object.entries(De).filter(n=>e.toLowerCase().includes(n[1].title.toLowerCase())&&D(e.toLowerCase(),n[1].title.toLowerCase())<e.length/2).sort((n,r)=>D(e.toLowerCase(),n[1].title.toLowerCase())-D(e.toLowerCase(),r[1].title.toLowerCase()))[0];switch(e.toLowerCase()){case"bastillion":return{url:lt,padding:!0,type:"Image"};case"betterment":return{url:ut,type:"Image"};case"carta":return{url:dt,type:"Image"};case"facebook":return{...Pe,padding:!1,type:"Icon"};case"guideline":return{url:ft,type:"Image"};case"id.me":return{url:mt,type:"Image"};case"justworks":return{url:gt,type:"Image"};case"nas":return{...Me,type:"Icon"};case"uw credit union":case"uwcu":return{url:pt,padding:!0,type:"Image"}}return s?{...s[1],type:"Icon",padding:!0}:void 0}const M="bg-slate-900",xt="bg-slate-800";function yt(e){if(!e||e.type==="Image")return{background:M,fill:xt};const s=e;let n=M,r="#"+s.hex;switch(s.title.toLowerCase()){case"amazon":n=M;break;case"microsoft":r="#00a2ed";break;case"github":case"patreon":case"ubisoft":n="bg-slate-100";break}return{background:n,fill:r}}function se({name:e,className:s}){const n=ht(e),r=yt(n),o="w-12 h-12 rounded-full border border-slate-400 flex justify-center items-center aspect-square "+r.background+" "+s;return n?n.type==="Image"?t.jsx("img",{src:n.url,className:C(o,"object-cover",n.padding&&"p-1")}):t.jsx("div",{dangerouslySetInnerHTML:{__html:n.svg},className:C(o,n.padding?"p-2.5":"p-0.5"),style:{fill:r.fill}}):t.jsx("div",{className:o,children:t.jsx(J,{})})}function wt({close:e,onScan:s}){return t.jsx("div",{className:"absolute inset-0 w-screen h-screen bg-black flex justify-center z-10",children:t.jsxs("div",{className:"relative w-[100vh] p-2",children:[t.jsx("div",{className:"absolute bottom-14 right-0 left-0 z-10 flex justify-center",children:t.jsx("button",{className:"icon",onClick:e,children:t.jsx(B,{})})}),t.jsx(Re,{onResult:async n=>{try{const r=new URL(n),o=decodeURIComponent(r.pathname.replace("//totp/","")).split(":")[0],a=r.searchParams.get("secret");if(r.protocol!=="otpauth:"||!o||!a)throw new Error(`Invalid URL: ${r.toString()}`);s(o,a),e()}catch(r){console.error(r),h.error("Failed to scan qr code")}},onError:n=>console.error(n==null?void 0:n.message),components:{audio:!1}})]})})}function bt(e){const[s,n]=f.useState(e.name||""),[r,o]=f.useState(e.secret||""),[a,i]=f.useState(!1),[c,l]=f.useState(!0),[u,x]=f.useState(!1),p=f.useContext(F)||"",d=e.name||e.secret,m=async(g,b)=>{if(g===""||b===""){h.error("Name and secret are required");return}try{x(!0),d&&(e.name!==g||e.secret!==b)&&await A(e.userRef,{keys:H({name:e.name,secret:e.secret})});const w=await I(p,{secret:b});await A(e.userRef,{keys:W({name:g,secret:w})}),n(""),o(""),l(!0),e.close()}catch(w){console.error(w),h.error("Failed to add key")}finally{x(!1)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-col gap-8",onKeyDown:g=>{g.key==="Enter"&&m(s,r)},children:[t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(se,{name:s,className:"w-14 h-14 sm:w-16 sm:h-16"}),t.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[t.jsx("input",{value:s,onChange:g=>n(g.target.value),placeholder:"Site name",autoFocus:!0,autoComplete:"false",type:"text"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{value:r,onChange:g=>o(g.target.value),placeholder:"Secret",autoComplete:"false",type:c?"password":"text"}),t.jsx("button",{className:"absolute right-0 top-0 bottom-0 flex items-center cursor-pointer bg-transparent",onClick:()=>l(!c),children:c?t.jsx(ge,{}):t.jsx(pe,{})})]})]})]}),t.jsxs("div",{className:"flex gap-4",children:[!d&&t.jsx("button",{onClick:()=>i(!0),children:t.jsx(he,{})}),t.jsx("button",{onClick:()=>m(s,r),className:"flex-1",disabled:u,children:u?d?"Saving":"Adding":d?"Save":"Add"})]})]}),a&&t.jsx(wt,{close:()=>i(!1),onScan:(g,b)=>{n(g),o(b)}})]})}function jt({onClose:e,title:s,children:n}){return t.jsx("div",{className:"fixed z-10 inset-0 bg-slate-900 bg-opacity-75 flex justify-center items-center",onClick:e,onKeyDown:r=>{r.key==="Escape"&&e()},children:t.jsxs("div",{className:"bg-slate-700 rounded-lg p-8 w-full",onClick:r=>r.stopPropagation(),style:{marginTop:"calc(-1 * env(keyboard-inset-height))",maxWidth:"min(80vw, 600px)"},children:[t.jsxs("div",{className:"flex items-center mb-8",children:[t.jsx("h2",{className:"flex-1 text-xl font-medium",children:s}),t.jsx("button",{onClick:e,className:"px-2 bg-slate-600 border-2 border-slate-800",children:t.jsx(B,{})})]}),n]})})}function vt(){const[e,s]=f.useState(null);return[f.useCallback(async r=>{if(!(navigator!=null&&navigator.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(r),s(r),!0}catch(o){return console.warn("Copy failed",o),s(null),!1}},[]),e]}function At(){const[e,s]=f.useState(!1);return f.useEffect(()=>{const n=()=>{s(window.innerWidth<500)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),e}function Ct({data:e,userRef:s,timestamp:n,onEdit:r,setEditMode:o,editMode:a}){const i=f.useContext(F)||"",[c,l]=f.useState(""),[u,x]=f.useState(0),p=At(),[d]=vt(),m=()=>{a?r():u===0?x(1):S()},g=E(()=>o(!a),m);f.useEffect(()=>{u!==0&&N(i,e.secret).then(y=>l(y.secret)).catch(y=>{console.error(y),l("Error")})},[e.secret,i,u]);const b=Math.floor(n.getTime()/3e4),w=f.useMemo(()=>{if(c.length===0||c==="Error"||u===0)return"Token Error";try{return xe.generate(c.replace(/\s+/g,""),{timestamp:b*3e4}).otp}catch(y){return console.error(y),"Token Error"}},[c,b,u]),S=f.useCallback(()=>d(w).then(y=>{y&&w!=="Token Error"?h.success(e.name+" code copied",{bodyClassName:p?"text-right":"",autoClose:2500}):h.error("Failed to copy code",{autoClose:2500})}),[w,e,p,d]);return f.useEffect(()=>{u===1&&w!=="Token Error"&&(S(),x(2))},[u,w]),t.jsxs("div",{className:C("p-3 bg-slate-800 border border-slate-700 rounded-md select-none flex gap-6 justify-between items-center hover:brightness-[90%] relative cursor-pointer transition-all rotate-0",a&&"animate-wiggle"),style:{animationDelay:`${Math.random()*250}ms`},tabIndex:0,...g(),onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&m()},children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx(se,{name:e.name}),t.jsxs("div",{className:"flex flex-col items-start justify-center",children:[t.jsx("h2",{className:"font-bold capitalize",children:e.name}),t.jsx("div",{children:u===0?"*** ***":c.length===0?"Decrypting...":w==="Token Error"?"Token Error":t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2",children:w.slice(0,3)}),t.jsx("span",{children:w.slice(3,6)})]})})]})]}),t.jsx("button",{className:"absolute -top-3 -right-3 !p-1 text-slate-800 bg-white border border-slate-400 rounded-full hover:text-white hover:brightness-100 sm:hover:bg-danger transition-all duration-300",style:{pointerEvents:a?"auto":"none",opacity:a?1:0},tabIndex:a?0:-1,onClick:y=>{y.stopPropagation(),window.confirm(`Are you sure you want to remove ${e.name}? This cannot be undone!`)&&window.confirm("Are you really sure?")&&A(s,{keys:H(e)})},onMouseDown:y=>y.stopPropagation(),onTouchStart:y=>y.stopPropagation(),onPointerDown:y=>y.stopPropagation(),children:t.jsx(B,{})})]})}function kt({userData:e,userRef:s,editMode:n,setEditMode:r,editKey:o,setEditKey:a}){const{time:i,timestamp:c}=it(),l=f.useContext(F)||"",[u,x]=f.useState(""),[p,d]=f.useState(),m=ct(),g=3e4-i.getTime()%3e4,b=Math.ceil(g/1e3),w=30-b;f.useEffect(()=>()=>{r(!1),a(!1)},[]),f.useEffect(()=>{n&&navigator.vibrate&&navigator.vibrate(200)},[n]);const S=f.useMemo(()=>t.jsxs(t.Fragment,{children:[e.keys.length===0&&t.jsx("div",{className:"text-center text-lg bg-slate-800 p-8 w-full rounded-md",children:"No keys added yet"}),e.keys.length>0&&t.jsxs("div",{className:"w-full max-w-screen-lg",children:[t.jsxs("div",{className:"flex gap-4 sm:gap-6 items-center mb-6",children:[t.jsx("img",{src:ee,className:"h-10 aspect-square -mb-0.5"}),t.jsxs("div",{className:"relative w-full",children:[t.jsx("input",{className:"pl-10",type:"search",value:u,placeholder:"Search tokens",onChange:j=>x(j.target.value)}),t.jsx("svg",{className:"fill-slate-400 absolute left-3 top-[11px] h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:t.jsx("path",{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"})})]})]}),t.jsx("div",{className:"w-full grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6",children:e.keys.filter(j=>u.length===0||j.name.toLowerCase().includes(u.toLowerCase())).sort((j,v)=>j.name.localeCompare(v.name)).map(j=>{try{return t.jsx(Ct,{data:j,userRef:s,timestamp:c,onEdit:()=>{const v=h.info("Decrypting token...",{autoClose:1500});N(l,j.secret).then(T=>{h.dismiss(v),a(!0),d({name:j.name,secret:T.secret})}).catch(T=>{h.dismiss(v),console.error(T),h.error("Failed to decrypt token",{autoClose:2500})})},setEditMode:r,editMode:n},j.name)}catch(v){return console.error(v),t.jsxs("div",{children:["Error Loading Token (",j.name,")"]})}})})]})]}),[e.keys,u,c,s,n]),y=(w+.15)/29.4*50;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex sm:justify-center pl-8 sm:pl-0 fixed bottom-0 left-0 right-0 z-10 backdrop-blur-lg bg-slate-900 bg-opacity-30 pt-4 border-t-2 border-secondary",children:[t.jsx("div",{className:"w-16 h-16 p-1 mb-6",children:t.jsx(ye,{value:b-1,maxValue:30,text:b.toString(),styles:we({textSize:"40px",trailColor:m.theme.colors.slate[700],textColor:m.theme.colors.primary,pathColor:m.theme.colors.primary}),strokeWidth:10})}),t.jsx("div",{className:"fixed bottom-1 h-1.5 bg-primary transition-all duration-700 z-20 rounded",style:{left:`${y}%`,right:`${y}%`}})]}),t.jsx("div",{className:"flex flex-col gap-4 m-6 sm:m-8 items-center pb-24",children:S}),o&&t.jsx(jt,{title:p!=null&&p.name||p!=null&&p.secret?"Edit existing key":"Add a new key",onClose:()=>{a(!1),d(void 0)},children:t.jsx(bt,{name:p==null?void 0:p.name,secret:p==null?void 0:p.secret,userRef:s,close:()=>{a(!1),d(void 0)}})})]})}function Nt(){const[e,s,n]=z(k);return Ue(),s||n?t.jsx(L,{children:n&&t.jsxs("p",{children:["Error: ",n.message]})}):e?t.jsx(St,{user:e}):t.jsx(L,{children:t.jsx(rt,{})})}async function Z(e){let s="",n=0;for(;s.length!==6&&n<3;)s=prompt("Set a new 6 digit pin")||"",n++;if(s.length===6&&(prompt("Re-enter 6 digit pin")||"")!==s){h.error("Pins do not match");return}if(s.length===6){e||(e=crypto.getRandomValues(new Uint32Array(32)).toString());try{return await I(s,{token:e})}catch(r){console.error(r)}}}function q({className:e}){return ze()?null:t.jsx(be,{className:O("text-danger fixed top-2 right-2 text-2xl z-10 "+e),title:"You are currently offline. It is not recommend to add/edit keys offline to avoid conflicts."})}function St({user:e}){var d;const{value:s,loading:n,error:r,userRef:o}=Ge(),[a,i]=f.useState(),[c,l]=f.useState(!1),[u,x]=f.useState(!1);_(m=>{m||i(void 0)}),f.useEffect(()=>{!n&&!r&&(s==null?void 0:s.data())===void 0&&Z().then(m=>{m?Te(o,{keys:[],email:e.email||"",code:m,webauthn:[]}):h.error("Failed to create user")})},[s,n,r]);const p=async()=>{if(!confirm("Would you like to update your pin?"))return;const m=await Z(a);m?A(o,{code:m}):h.error("Failed to update pin")};return n||r||!s||s.data()===void 0?t.jsxs(L,{children:[r&&t.jsxs("p",{children:["Error: ",r.message]}),!s||s.data()===void 0&&t.jsx("p",{children:"No data"})]}):a?t.jsxs(F.Provider,{value:a,children:[t.jsx(q,{}),t.jsx(kt,{userData:s.data(),userRef:o,editMode:c,setEditMode:l,editKey:u,setEditKey:x}),t.jsx(at,{lock:()=>i(void 0),updateCode:p,editMode:c,setEditKey:x,setEditMode:l,exportKeys:()=>Xe(a,s.data()),importKeys:()=>Ze(a,s.data(),o)})]}):t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"!bottom-4 !right-5 top-auto"}),t.jsx(nt,{unlock:m=>i(m),encryptedCode:(d=s.data())==null?void 0:d.code,data:s.data(),userRef:o})]})}window.global||(window.global=window);globalThis.Buffer=je.Buffer;const Lt=matchMedia("(display-mode: browser)").matches;Lt||window.resizeTo(500,760);const V=navigator;V.virtualKeyboard&&(V.virtualKeyboard.overlaysContent=!0);function Et(){return t.jsxs(f.StrictMode,{children:[t.jsx(Nt,{}),t.jsx(Ae,{theme:"dark",position:"bottom-center",transition:Ce,hideProgressBar:!0,closeButton:!1})]})}ve(document.getElementById("root")).render(t.jsx(Et,{}));export{zt as a,Pt as c,Rt as g};
//# sourceMappingURL=index-BAvtVnfR.js.map
